<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">

<script>
    (function(){
        if(''){
            if (prompt('请输入密码') !== ''){
                alert('密码错误');
                history.back();
            }
        }
    })();
</script>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="CTF,Crypto,Reverse,Writeup,RealWorld," />










<meta name="description" content="2020年最后的一次比赛，共三场，一直想复盘一下再写WP的，最终还是咕了。。。鲲鹏计算专场独自解了两道逆向+一道半Crypto+两道RealWorld，也是校队第一次进XCTF分站赛前十鸿蒙专场AK了5道逆向+1道RealWorld，可惜当天起得晚了点加上中午有点事，基本都是四血，不过此次队友十分给力，短暂登过顶，最终也苟进了第五，算是2020年最好的成绩了！">
<meta property="og:type" content="article">
<meta property="og:title" content="2020XCTF-华为系列专场 部分Writeup">
<meta property="og:url" content="http://yoursite.com/2021/01/09/2020XCTF-HUAWEICTF/index.html">
<meta property="og:site_name" content="feng&#39;s blog">
<meta property="og:description" content="2020年最后的一次比赛，共三场，一直想复盘一下再写WP的，最终还是咕了。。。鲲鹏计算专场独自解了两道逆向+一道半Crypto+两道RealWorld，也是校队第一次进XCTF分站赛前十鸿蒙专场AK了5道逆向+1道RealWorld，可惜当天起得晚了点加上中午有点事，基本都是四血，不过此次队友十分给力，短暂登过顶，最终也苟进了第五，算是2020年最好的成绩了！">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://yoursite.com/images/xctf-huawei/ytTRwrwgwbmlDZpsewij1g.png">
<meta property="article:published_time" content="2021-01-08T16:00:00.000Z">
<meta property="article:modified_time" content="2021-01-09T08:39:43.583Z">
<meta property="article:author" content="feng">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="Reverse">
<meta property="article:tag" content="Writeup">
<meta property="article:tag" content="RealWorld">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/images/xctf-huawei/ytTRwrwgwbmlDZpsewij1g.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2021/01/09/2020XCTF-HUAWEICTF/"/>





  <title>2020XCTF-华为系列专场 部分Writeup | feng's blog</title>
  








<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">feng's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/01/09/2020XCTF-HUAWEICTF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="feng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/feng.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="feng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">2020XCTF-华为系列专场 部分Writeup</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2021-01-09T00:00:00+08:00">
                2021-01-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>2020年最后的一次比赛，共三场，一直想复盘一下再写WP的，最终还是咕了。。。<br>鲲鹏计算专场独自解了两道逆向+一道半Crypto+两道RealWorld，也是校队第一次进XCTF分站赛前十<br>鸿蒙专场AK了5道逆向+1道RealWorld，可惜当天起得晚了点加上中午有点事，基本都是四血，不过此次队友十分给力，短暂登过顶，最终也苟进了第五，算是2020年最好的成绩了！</p>
<a id="more"></a>

<h2 id="鲲鹏计算专场-Crypto"><a href="#鲲鹏计算专场-Crypto" class="headerlink" title="鲲鹏计算专场 - Crypto"></a>鲲鹏计算专场 - Crypto</h2><h3 id="combinelfsr"><a href="#combinelfsr" class="headerlink" title="combinelfsr"></a><strong>combinelfsr</strong></h3><p>lfsr，参考<a href="https://www.anquanke.com/post/id/184828" target="_blank" rel="noopener">https://www.anquanke.com/post/id/184828</a></p>
<p><strong>z3 求 R1，R2</strong></p>
<p>R2= 90307  </p>
<p>R1 = 13706</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line"></span><br><span class="line">class lfsr():</span><br><span class="line">def __init__(self, init, mask, length):</span><br><span class="line">self.init &#x3D; init</span><br><span class="line">self.mask &#x3D; mask</span><br><span class="line">self.lengthmask &#x3D; 2**(length+1)-1</span><br><span class="line">self.length &#x3D; length</span><br><span class="line"></span><br><span class="line">def next(self):</span><br><span class="line">        nextdata &#x3D; (self.init &lt;&lt; 1) &amp; self.lengthmask</span><br><span class="line">        i &#x3D; self.init &amp; self.mask &amp; self.lengthmask</span><br><span class="line">        output &#x3D; 0</span><br><span class="line">for j in range(self.length):</span><br><span class="line">            output ^&#x3D; (i &amp; 1)</span><br><span class="line">            i &#x3D; i &gt;&gt; 1</span><br><span class="line">        nextdata ^&#x3D; output</span><br><span class="line">self.init &#x3D; nextdata</span><br><span class="line">return output</span><br><span class="line"></span><br><span class="line">def combine(x1,x2):</span><br><span class="line">return (x1*x2)^(x2^1)</span><br><span class="line"></span><br><span class="line">init1 &#x3D; BitVec(&#39;init1&#39;, 18)</span><br><span class="line">init2 &#x3D; BitVec(&#39;init2&#39;, 18)</span><br><span class="line"></span><br><span class="line">l1 &#x3D; lfsr(init1, 0b110000010100010111, 18)</span><br><span class="line">l2 &#x3D; lfsr(init2, 0b100101101101110100, 18)</span><br><span class="line"></span><br><span class="line">s &#x3D; Solver()</span><br><span class="line">with codecs.open(&#39;out&#39;, &#39;rb&#39;) as f:</span><br><span class="line">    keystream &#x3D; f.read()</span><br><span class="line"></span><br><span class="line">outputs &#x3D; []</span><br><span class="line">for i in keystream:</span><br><span class="line">    a &#x3D; ord(i)</span><br><span class="line">    b &#x3D; &#39;0&#39;*(8 - len(bin(a)[2:])) + bin(a)[2:]</span><br><span class="line">for j in b:</span><br><span class="line">        outputs.append(int(j))</span><br><span class="line"></span><br><span class="line">for i in range(80):</span><br><span class="line">    s.add(outputs[i] &#x3D;&#x3D; combine(l1.next(), l2.next()))</span><br><span class="line"></span><br><span class="line">s.check()</span><br><span class="line">print(s.model())</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># from z3</span><br><span class="line">R2&#x3D; 90307</span><br><span class="line">R1 &#x3D; 13706</span><br><span class="line"></span><br><span class="line">from hashlib import sha512</span><br><span class="line">import random</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">key &#x3D; sha512(str(R1)+str(R2)).digest()[:16]</span><br><span class="line">aes &#x3D; AES.new(key,AES.MODE_ECB)</span><br><span class="line">flag&#x3D; &#39;\xb5\xbc\x56\xc1\x7d\xb4\xa7\xd8\x98\xce\x63\x65\x2d\x36\x56\x57\x2e\x4f\x5b\x67\x57\xfc\xce\xf8\xd8\xd3\xa3\x2d\xc6\x0b\xfc\x97\x2d\x40\xf0\x61\xf3\xa7\x15\x4f\x79\x75\xd5\x12\x6b\x05\x2d\xad&#39;</span><br><span class="line">flag &#x3D; aes.decrypt(flag)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p><strong>flag{d0b570e1-5292-4381-9d71-d6edab490854}</strong></p>
<h3 id="RRSSAA"><a href="#RRSSAA" class="headerlink" title="RRSSAA"></a><strong>RRSSAA</strong></h3><p>简单的rsa，总共有三部分，part1直接解，part2利用韦达定理解</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import next_prime,invert,gcd,iroot</span><br><span class="line">from sympy import nextprime</span><br><span class="line">import os </span><br><span class="line">#level1</span><br><span class="line"># x &#x3D; getPrime(290)</span><br><span class="line"># y &#x3D; next_prime(21*x)</span><br><span class="line"># z &#x3D; next_prime(3*x*y)</span><br><span class="line"># n1 &#x3D; x*y*z</span><br><span class="line"># n1 &#x3D; x*21*x*3*x*21*x &#x3D;&#x3D; 1323*x^4</span><br><span class="line">e &#x3D; 0x10001</span><br><span class="line">def level1(c):</span><br><span class="line">    n &#x3D; 7296833146437859657873621309783663953888975990236533231501856312811032923469834028894995888763882827280881148914714991084488173289859941577252999932599209531912854472326211936264815965582591809770319779712527572174152560819828597241583278731544411246154674514626001858732363262751244419415544407653873858309154132440262888841600498885105451586030156787</span><br><span class="line">    x4 &#x3D; n&#x2F;1323</span><br><span class="line">    tmp &#x3D; iroot(x4,4)[0] - 1000</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">        x &#x3D; nextprime(tmp)</span><br><span class="line">        y &#x3D; nextprime(21*x)</span><br><span class="line">        z &#x3D; nextprime(3*x*y)</span><br><span class="line">if x*y*z  &#x3D;&#x3D; n:</span><br><span class="line">            phi &#x3D; (x-1)*(y-1)*(z-1)</span><br><span class="line">            d &#x3D; invert(e,phi)</span><br><span class="line">            m &#x3D; pow(c,d,n)</span><br><span class="line">return m</span><br><span class="line">else:</span><br><span class="line">            tmp &#x3D; nextprime(tmp)</span><br><span class="line"></span><br><span class="line"># level2 </span><br><span class="line">def level2(c):</span><br><span class="line">    c2 &#x3D; 1053537887874546462592488085073845416926774134662726673037396087573784978051621217625148167597158934482623108020431156088398328744249523064321014736213368948953544152743794110597131811143693267135550808438361187122132326433146425956042304765054715382524604818750722275967881325495437747007634396550743199481837826028546371516957749823388589606139743433172347723</span><br><span class="line">    oxs &#x3D; 2966384769329081457959929210854946307725303451729041111756565081822209869706734847077404063837454548238096227843381458842322035116059935545789370388767999132347222281376931478665079</span><br><span class="line">    n2 &#x3D; 8799438599707547810413590252769637047669730373282934937368515093438977181200080057948977998859737775815535703211966248578669447308370171323881776611030752648135480196879162497896464322936833458775227550623435000527614781055524145936353357662536280470664112516976033358499330391929435857811788923590666783090016628619936968367309955759172412259970189158362661969</span><br><span class="line"></span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">    o &#x3D; getPrime(300)</span><br><span class="line">    s &#x3D; getPrime(300)</span><br><span class="line">    t &#x3D; next_prime(o)</span><br><span class="line">    u &#x3D; next_prime(s)</span><br><span class="line"></span><br><span class="line">    a &#x3D; o*s + t*u</span><br><span class="line">    b &#x3D; t*s + u*o</span><br><span class="line">    print(a-b)</span><br><span class="line">    &#39;&#39;&#39;</span><br><span class="line"></span><br><span class="line">    txu &#x3D; n2&#x2F;&#x2F;oxs</span><br><span class="line">print(oxs*txu &#x3D;&#x3D; n2)</span><br><span class="line">    a &#x3D; oxs+txu</span><br><span class="line">for i in range(1, 100000):</span><br><span class="line">        b &#x3D; a-i</span><br><span class="line">        delta &#x3D; b**2 - 4*n2</span><br><span class="line">if delta&lt;0:</span><br><span class="line">continue</span><br><span class="line">        rdelta &#x3D; iroot(delta,2)</span><br><span class="line">if rdelta[1]:</span><br><span class="line">print(i, b)</span><br><span class="line"># from sage</span><br><span class="line">    r1 &#x3D; 2966384769329081457959929210854946307725303451729041111756565081822209869706734847077404651306368582818672174524720657329423156396400608586670887330204238883628829887762408566296707</span><br><span class="line">    r2 &#x3D; 2966384769329081457959929210854946307725303451729041111756565081822209869706734847077404379002848561827294305095639384473736092631731049929066639898110490671436971914521438376531867</span><br><span class="line"></span><br><span class="line">    o &#x3D; gcd(r1, oxs)</span><br><span class="line">    s &#x3D; gcd(r2, oxs)</span><br><span class="line">    t &#x3D; next_prime(o)</span><br><span class="line">    u &#x3D; next_prime(s)</span><br><span class="line">print(o*s*t*u &#x3D;&#x3D; n2)</span><br><span class="line"></span><br><span class="line">    phi &#x3D; (o-1)*(s-1)*(t-1)*(u-1)</span><br><span class="line">    d &#x3D; invert(e, phi)</span><br><span class="line">    m &#x3D; pow(c2, d, n2)</span><br><span class="line">print(m)</span><br><span class="line">return m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def level3():</span><br><span class="line">    n3 &#x3D; 24502730939655407292543436897382196297516664227273320602397906878696723372242877776550446563950867624819352853122033114711732125433588724779869985477495098802744344448915032607469954642257825855931872281908232331623829725043031800535739432133948607448362641204034546581444904408754892037110031202573463399201625812005615264689877537231974023870006792196961829162058446662172634212427186470724599941352830546043772969297733239518604749366684163813795999625784931375110137805143337329</span><br><span class="line">    mr &#x3D; 81225738828166640599054154023183465870678960906769673605358084529196871174429427936591822589995476552044227730868809310992934103731850597399114246762836121101348301079296663951503688072299542357013093324718850936925265954204973634470836187733828189312553819810470405246669124171178070485118436102895117354417</span><br><span class="line">    cr &#x3D; 22238585749689335043198360403653248049710943304594623939441271714322821476047298977043454290592085809700500599520080107736858423927071836758485527270617538166045213386679961664240306883126224169183649140929168343634245637578487850945986688768857954082116136864696582066988005306045105860368497626822666433678879698344619056273526837700698315346972423482713305543394110949178233504551465821354514535155389087138867576532139739270960823294873497825040963862751772914087741831403951901</span><br><span class="line">    c3 &#x3D; 2385064917660948806957457681641614888669217960607006360543268900921017481245498563263991410918604891314384810533439253814523067168636768976220059028108900592323119524657903364697700329145453517769093265052715204625870232288203427545150983037310876534801548309890853026234248412421497939811385725642492104262954059677793538707604205179344884142656842895567795000647837461835179395742399372683460208271310884657279893532539121893558143029933794905470899127632780110459122203796256514</span><br><span class="line"></span><br><span class="line">    mrinv3 &#x3D; invert(pow(mr, 3, n3), n3)</span><br><span class="line">    cr2 &#x3D; cr*mrinv3 % n3</span><br><span class="line">    kp &#x3D; pow(mr, 4)-cr2</span><br><span class="line">    p &#x3D; gcd(kp, n3)</span><br><span class="line">    q &#x3D; n3&#x2F;&#x2F;p</span><br><span class="line">print(p*q &#x3D;&#x3D; n3)</span><br><span class="line"></span><br><span class="line">    phi &#x3D; (p-1)*(q-1)</span><br><span class="line">while True:</span><br><span class="line">        s &#x3D; getPrime(10)</span><br><span class="line">if(gcd(s,p-1) &#x3D;&#x3D; 1):</span><br><span class="line">            sinv &#x3D; invert(s,p-1)</span><br><span class="line">            e &#x3D; 4*s*sinv+3</span><br><span class="line">if pow(mr, e, n3)&#x3D;&#x3D;cr:</span><br><span class="line">print(s, e)</span><br><span class="line">break</span><br><span class="line">    d &#x3D; invert(e, phi)</span><br><span class="line">    m3 &#x3D; pow(c3, d, n3)</span><br><span class="line">print(m3)</span><br><span class="line">return m3</span><br><span class="line"></span><br><span class="line">print long_to_bytes(level1(level2(level3())))</span><br></pre></td></tr></table></figure>

<p> <strong>flag{4c2fd4e6-44de-445f-8c34-1235464de2de}</strong></p>
<h2 id="鲲鹏计算-amp-amp-鸿蒙专场-Reverse"><a href="#鲲鹏计算-amp-amp-鸿蒙专场-Reverse" class="headerlink" title="鲲鹏计算 &amp;&amp; 鸿蒙专场 - Reverse"></a>鲲鹏计算 &amp;&amp; 鸿蒙专场 - Reverse</h2><p>逆向部分WP写得比较简单，较为详细的wp可以参考师妹的博客<a href="https://c10udlnk.top/2020/12/29/wpFor-2020XCTF/" target="_blank" rel="noopener">https://c10udlnk.top/2020/12/29/wpFor-2020XCTF/</a></p>
<h3 id="mips"><a href="#mips" class="headerlink" title="mips"></a><strong>mips</strong></h3><p>三个迷宫，走完就行，这道题多解</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">g &#x3D; [0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000003, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000004, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000003, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000004, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000003, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000004, 0x00000000, 0x00000000]</span><br><span class="line"></span><br><span class="line">for i in range(3):</span><br><span class="line">for j in range(15):</span><br><span class="line">for k in range(15):</span><br><span class="line">print(g[i*225+j*15+k],end&#x3D;&#39; &#39;)</span><br><span class="line">print()</span><br><span class="line">print(&#39;----------------&#39;)</span><br><span class="line"></span><br><span class="line">sssssssddddddds</span><br><span class="line">1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 </span><br><span class="line">1 1 1 1 1 0 3 0 1 0 0 0 0 0 0 </span><br><span class="line">1 1 1 1 1 0 1 0 1 0 0 0 0 0 0 </span><br><span class="line">1 1 1 1 1 0 1 0 1 0 0 0 0 0 0 </span><br><span class="line">1 1 1 1 1 0 1 0 1 1 1 1 1 0 0 </span><br><span class="line">1 1 1 1 1 0 1 0 0 0 0 0 1 0 0 </span><br><span class="line">1 1 1 1 1 0 1 0 0 0 0 0 1 0 0 </span><br><span class="line">1 1 1 1 1 0 1 0 0 0 0 0 1 1 0 </span><br><span class="line">1 1 1 1 1 0 1 1 1 1 1 1 1 1 0 </span><br><span class="line">1 1 1 1 1 0 0 0 0 0 0 0 0 4 0 </span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 </span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 </span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 </span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 </span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 </span><br><span class="line">----------------</span><br><span class="line"></span><br><span class="line">ssssssssssdddddddddds</span><br><span class="line">1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 </span><br><span class="line">1 1 0 3 0 1 1 1 1 0 0 0 0 0 0 </span><br><span class="line">1 1 0 1 0 0 0 0 1 0 0 0 0 0 0 </span><br><span class="line">1 1 0 1 0 0 0 0 1 0 0 0 0 0 0 </span><br><span class="line">1 1 0 1 1 0 0 0 1 1 1 1 1 0 0 </span><br><span class="line">1 1 0 1 1 0 0 0 0 0 0 0 1 0 0 </span><br><span class="line">1 1 0 1 1 0 0 0 0 0 0 0 1 0 0 </span><br><span class="line">1 1 0 1 1 0 0 0 0 0 1 1 1 1 0 </span><br><span class="line">1 1 0 1 1 0 0 0 0 0 1 0 0 1 0 </span><br><span class="line">1 1 0 1 1 0 0 0 0 0 1 0 0 0 0 </span><br><span class="line">1 1 0 1 1 1 1 1 1 0 1 0 1 1 0 </span><br><span class="line">1 1 0 1 1 1 1 1 1 1 1 1 1 1 0 </span><br><span class="line">1 1 0 0 0 0 0 0 0 0 0 0 0 4 0 </span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 </span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 </span><br><span class="line">----------------</span><br><span class="line"></span><br><span class="line">ddssddwddssssssdddssssdddss</span><br><span class="line">0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 </span><br><span class="line">0 3 1 1 0 0 0 0 0 0 0 0 0 0 0 </span><br><span class="line">0 0 0 1 0 1 1 1 0 0 0 0 0 0 0 </span><br><span class="line">0 0 0 1 1 1 0 1 0 0 0 0 0 0 0 </span><br><span class="line">0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 </span><br><span class="line">0 1 1 0 1 0 0 1 0 0 0 0 0 0 0 </span><br><span class="line">0 0 1 1 1 0 0 1 0 0 0 0 0 0 0 </span><br><span class="line">0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 </span><br><span class="line">0 0 0 0 0 0 0 1 1 1 1 0 0 0 0 </span><br><span class="line">0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 </span><br><span class="line">0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 </span><br><span class="line">0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 </span><br><span class="line">0 0 0 0 0 0 0 0 0 0 1 1 1 1 0 </span><br><span class="line">0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 </span><br><span class="line">0 0 0 0 0 0 0 0 0 0 0 0 0 4 0</span><br></pre></td></tr></table></figure>

<h3 id="pypy"><a href="#pypy" class="headerlink" title="pypy"></a><strong>pypy</strong></h3><p>解包，反编译 <a href="https://github.com/extremecoders-re/pyinstxtractor/wiki/Extracting-Linux-ELF-binaries" target="_blank" rel="noopener">https://github.com/extremecoders-re/pyinstxtractor/wiki/Extracting-Linux-ELF-binaries</a></p>
<p>rc4，这里注意python3的encode</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"># from Crypto.Cipher import ARC4</span><br><span class="line"># key &#x3D; b&#39;Y\xf3\x02\xc3%\x9a\x820\x0b\xbb%\x7f~;\xd2\xdc&#39;</span><br><span class="line"># c &#x3D; b&#39;\x27\x5b\x39\xc3\x81\xc2\x8b\x70\x1a\xc3\x97\x23\x38\x45\x60\x22\xc2\xba\x06\xc3\xb0\x4f\x55\x01\x47\x1c\x47\xc3\x8a\xc3\x80\xc2\x9b\x72\xc3\xb5\xc3\x8a\x7e\xc2\xa5\xc2\xa0&#39;</span><br><span class="line"># print(c)</span><br><span class="line"># enc &#x3D; ARC4.new(key)</span><br><span class="line"># print(enc.decrypt(c))</span><br><span class="line">DEFAULT_KEY &#x3D; u&#39;Y\xf3\x02\xc3%\x9a\x820\x0b\xbb%\x7f~;\xd2\xdc&#39;</span><br><span class="line">def rc4(v11, key&#x3D;DEFAULT_KEY, skip&#x3D;1024):</span><br><span class="line">    v12 &#x3D; 0</span><br><span class="line">    v13 &#x3D; bytearray([v14 for v14 in range(256)])</span><br><span class="line">    v12 &#x3D; 0</span><br><span class="line">for v15 in range(256):</span><br><span class="line">        v12 &#x3D; (v12 + v13[v15] + ord(key[(v15 % len(key))])) % 256</span><br><span class="line">        v16 &#x3D; v13[v15]</span><br><span class="line">        v17 &#x3D; v13[v12]</span><br><span class="line">        v13[v15] &#x3D; v13[v12]</span><br><span class="line">        v13[v12] &#x3D; v16</span><br><span class="line">else:</span><br><span class="line">        v12 &#x3D; 0</span><br><span class="line">        v18 &#x3D; 0</span><br><span class="line">        v19 &#x3D; []</span><br><span class="line">if skip &gt; 0:</span><br><span class="line">for v15 in range(skip):</span><br><span class="line">                v12 &#x3D; (v12 + 1) % 256</span><br><span class="line">                v18 &#x3D; (v18 + v13[v12]) % 256</span><br><span class="line">                v13[v12], v13[v18] &#x3D; v13[v18], v13[v12]</span><br><span class="line"></span><br><span class="line">for v20 in v11:</span><br><span class="line">            v12 &#x3D; (v12 + 1) % 256</span><br><span class="line">            v18 &#x3D; (v18 + v13[v12]) % 256</span><br><span class="line">            v13[v12], v13[v18] &#x3D; v13[v18], v13[v12]</span><br><span class="line">            v21 &#x3D; v13[((v13[v12] + v13[v18]) % 256)]</span><br><span class="line">            v19.append(chr(ord(v20) ^ v21))</span><br><span class="line">else:</span><br><span class="line">return &#39;&#39;.join(v19)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def func(v22):</span><br><span class="line">    v23 &#x3D; rc4(v22)</span><br><span class="line">return v23</span><br><span class="line"># if v23.encode(&#39;utf-8&#39;).hex() &#x3D;&#x3D; &#39;275b39c381c28b701ac3972338456022c2ba06c3b04f5501471c47c38ac380c29b72c3b5c38a7ec2a5c2a0&#39;:</span><br><span class="line">#     return &#39;YOU WIN&#39;</span><br><span class="line"># return &#39;YOU LOSE&#39;</span><br><span class="line">print func(u&#39;\x27\x5b\x39\xc3\x81\xc2\x8b\x70\x1a\xc3\x97\x23\x38\x45\x60\x22\xc2\xba\x06\xc3\xb0\x4f\x55\x01\x47\x1c\x47\xc3\x8a\xc3\x80\xc2\x9b\x72\xc3\xb5\xc3\x8a\x7e\xc2\xa5\xc2\xa0&#39;)</span><br><span class="line">print func(u&#39;\x27\x5b\x39\xc1\x8b\x70\x1a\xd7\x23\x38\x45\x60\x22\xba\x06\xf0\x4f\x55\x01\x47\x1c\x47\xca\xc0\x9b\x72\xf5\xca\x7e\xa5\xa0&#39;)</span><br><span class="line">print func(&#39;flag&#123;snake_bao_is_really_lucky&#125;&#39;).encode(&#39;hex&#39;)</span><br></pre></td></tr></table></figure>

<h3 id="re123"><a href="#re123" class="headerlink" title="re123"></a><strong>re123</strong></h3><p>chm文件，用chmdecompiler反编译，doc.htm有一段base64编码的powershell shellcode，解base64</p>
<p><img src="/images/xctf-huawei/ytTRwrwgwbmlDZpsewij1g.png" alt="img"></p>
<p>执行，得到一个pe，补文件头，可以看到就是一个简单的后门，aes加密，密文，密钥直接给出，直接解即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">key &#x3D; b&#39;\x2b\x7e\x15\x16\x28\xae\xd2\xa6\xab\xf7\x15\x88\x09\xcf\x4f\x3c&#39;</span><br><span class="line">cipher &#x3D; b&#39;\xb5\xf4\x3f\x45\x43\xd6\x99\xe7\x56\x1b\x2a\xaa\x84\x20\xc4\x46&#39;</span><br><span class="line"></span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line"></span><br><span class="line">enc &#x3D; AES.new(key,AES.MODE_ECB)</span><br><span class="line">print(enc.decrypt(cipher))</span><br></pre></td></tr></table></figure>

<p><strong>flag{youcangues}</strong></p>
<h3 id="crash"><a href="#crash" class="headerlink" title="crash"></a><strong>crash</strong></h3><p>crash包含多个可执行文件，binwalk分离获取主程序，password校验算法为按字节xor 0x17,之后每四个字节取md5和常量比对</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># &quot;bf2b36d56f5757c13cad80494b385e78&quot;</span><br><span class="line"># &quot;3fe9dbae5dc4408350500affa20074aa&quot;</span><br><span class="line"># &quot;1fa6770eca6b57e47a042ffe52eca8ff&quot;</span><br><span class="line"># &quot;1aad6b7da1122b4b5a53bf5a4d3b11b0&quot;</span><br><span class="line"># &quot;e7b77d9e0ab19fc9ea98154f994fccc5&quot;</span><br><span class="line"># &quot;75d9128cfeb61b8949664f6a067f6469&quot;</span><br><span class="line"># &quot;d8b0a52c64d6075017b7346140550c46&quot;</span><br><span class="line"># &quot;306529c7cdedfb06e27b39f7b2babf4d&quot;</span><br><span class="line"></span><br><span class="line">f &#x3D; &quot;bo&amp;tn&amp;o#~&#123;c|vut.yb&amp;y|&#39;&#39;s.v|gg &#96;&quot;</span><br><span class="line">print(&#39;flag&#123;&#39;,end&#x3D;&#39;&#39;)</span><br><span class="line">for i in list(f):</span><br><span class="line">print(chr(ord(i)^0x17),end&#x3D;&#39;&#39;)</span><br><span class="line">print(&#39;&#125;&#39;,end&#x3D;&#39;&#39;)</span><br></pre></td></tr></table></figure>

<p><strong>flag{ux1cy1x4iltkahbc9nu1nk00d9akpp7w}</strong></p>
<h3 id="arm"><a href="#arm" class="headerlink" title="arm"></a><strong>arm</strong></h3><p>arm架构，程序输入key和flag，用key作为随机数种子（取低8位）初始化随机数池，作为常数（取低8位+1）形成42元一次方程组，output.txt就是方程组的ans。</p>
<p>hook程序地址00107A0，使程序直接打印生成的随机数序列，共42*42个</p>
<p>之后只要遍历一个字节的key，尝试解方程即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import pexpect</span><br><span class="line">from sympy import *</span><br><span class="line"></span><br><span class="line"># data&#x3D;[]</span><br><span class="line"># with open(&#39;output.txt&#39;,&#39;r&#39;) as f:</span><br><span class="line">#     tmp&#x3D;f.read().split(&#39;\r\n&#39;)</span><br><span class="line">#     data&#x3D;[int(x,16) for x in tmp]</span><br><span class="line">#     print(data)</span><br><span class="line">data &#x3D; [775008, 736965, 579982, 832102, 739711, 689694, 621261, 786007, 687380, 870278, 671072, 705346, 695702, 726075, 693811, 726115, 797388, 839688, 798029, 773858, 732406, 632966, 740936, 775656, 710214, 858672, 686622, 608896, 815068, 521720, 693197, 560581, 885102, 635306, 732285, 770318, 702253, 632762, 839978, 813599, 651986, 875709]</span><br><span class="line">src &#x3D; [0xA0, 0xE4, 0xBA, 0xFB, 0x10, 0xDD, 0xAC, 0x65, 0x8D, 0x0B, 0x57, 0x1A, 0xE4, 0x28, 0x96, 0xB3, 0x0C, 0x79, 0x4D, 0x80, 0x90, 0x99, 0x58, 0xFE, 0x50, 0xD3, 0xF9, 0x3C, 0x0F, 0xC1, 0xE3, 0xA6, 0x39, 0xC3, 0x28, 0x75, 0xF8, 0xC9, 0xC8, 0xCD, 0x78, 0x26]</span><br><span class="line">flag &#x3D; &#39;flag&#123;000000000000000000000000000000000000&#125;&#39;</span><br><span class="line"></span><br><span class="line">var&#x3D;[]</span><br><span class="line">for num in range(42):</span><br><span class="line">    exec(&quot;x&quot;+str(num)+&quot;&#x3D;Symbol(&#39;x&#39;+str(num))&quot;)</span><br><span class="line">    var.append(&quot;x&quot;+str(num))</span><br><span class="line">for i in range(256):</span><br><span class="line">    r &#x3D; pexpect.spawn(&#39;.&#x2F;qemu-arm -L .&#x2F; .&#x2F;aRm_getRand&#39;)</span><br><span class="line">    r.sendline(str(i))</span><br><span class="line">    r.sendline(flag)</span><br><span class="line">    r.readline()</span><br><span class="line">    r.readline()</span><br><span class="line">    rand &#x3D; []</span><br><span class="line">    for j in range(42*42):</span><br><span class="line">        s &#x3D; r.readline()</span><br><span class="line">        rand.append(int(str(s)[2:-5],16))</span><br><span class="line">    r.wait()</span><br><span class="line">    exper&#x3D;[]</span><br><span class="line">    for j in range(42):</span><br><span class="line">        anEx&#x3D;&quot;&quot;</span><br><span class="line">        for k in range(42):</span><br><span class="line">            anEx+&#x3D;str(rand[j*42+k])+&quot;*&quot;+var[k]+&quot;+&quot;</span><br><span class="line">        anEx&#x3D;anEx[:-1]+&quot;-&quot;+str(data[j])</span><br><span class="line">        exper.append(anEx)</span><br><span class="line">    res&#x3D;solve(exper,var)</span><br><span class="line">    print(str(i)+&quot;: &quot;)</span><br><span class="line">    print(res.values())</span><br></pre></td></tr></table></figure>

<p>82: </p>
<p>dict_values([198, 136, 219, 156, 107, 228, 152, 7, 239, 63, 97, 127, 134, 5, 247, 131, 109, 75, 96, 180, 241, 173, 57, 211, 49, 224, 157, 9, 34, 243, 129, 199, 1, 244, 31, 17, 157, 171, 252, 249, 64, 91])</p>
<p>xor table getflag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">arr&#x3D;[0xA0, 0xE4, 0xBA, 0xFB, 0x10, 0xDD, 0xAC, 0x65, 0x8D, 0x0B, 0x57, 0x1A, 0xE4, 0x28, 0x96, 0xB3, 0x0C, 0x79, 0x4D, 0x80, 0x90, 0x99, 0x58, 0xFE, 0x50, 0xD3, 0xF9, 0x3C, 0x0F, 0xC1, 0xE3, 0xA6, 0x39, 0xC3, 0x28, 0x75, 0xF8, 0xC9, 0xC8, 0xCD, 0x78, 0x26]</span><br><span class="line">x&#x3D;[198, 136, 219, 156, 107, 228, 152, 7, 239, 63, 97, 127, 134, 5, 247, 131, 109, 75, 96, 180, 241, 173, 57, 211, 49, 224, 157, 9, 34, 243, 129, 199, 1, 244, 31, 17, 157, 171, 252, 249, 64, 91]</span><br><span class="line">flag&#x3D;&quot;&quot;</span><br><span class="line">for i in range(42):</span><br><span class="line">    flag+&#x3D;chr(x[i]^arr[i])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p><strong>flag{94bb46eb-a0a2-4a4a-a3d5-2ba877deb448}</strong></p>
<h3 id="arm-pe"><a href="#arm-pe" class="headerlink" title="arm_pe"></a><strong>arm_pe</strong></h3><p>windows-arm架构，无环境，静态硬刚</p>
<p>普莱费尔密码</p>
<p>密钥表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREIH</span><br><span class="line"></span><br><span class="line">TQGNU</span><br><span class="line"></span><br><span class="line">AOVXL</span><br><span class="line"></span><br><span class="line">DZKYM</span><br><span class="line"></span><br><span class="line">PBWFS</span><br></pre></td></tr></table></figure>

<p>密文</p>
<p>KIMLXDWRZXTHXTHQTXTXHZWC</p>
<p>按规则解密即可</p>
<p>YE SM AY BE YO UC AN RU NA NA RM PE</p>
<p>flag{YESMAYBEYOUCANRUNANARMPE}</p>
<h3 id="puzzle"><a href="#puzzle" class="headerlink" title="puzzle"></a><strong>puzzle</strong></h3><p>mips架构</p>
<p>一个华容道游戏，八数码问题，用现成的算法算出走的方向</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">#include &lt;ctime&gt;</span><br><span class="line">#include &lt;cstdlib&gt;</span><br><span class="line">#define maxState 10000</span><br><span class="line">#define N 3</span><br><span class="line">using namespace std;</span><br><span class="line">bool isEqual(int a[N][N][maxState],int b[N][N],int n)&#123;</span><br><span class="line">    for(int i &#x3D; 0;i &lt; N;i ++)&#123;</span><br><span class="line">        for(int j &#x3D; 0;j &lt; N;j ++)&#123;</span><br><span class="line">            if(a[i][j][n] !&#x3D; b[i][j]) return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br><span class="line">bool isEqual(int a[N][N],int b[N][N])&#123;</span><br><span class="line">    for(int i &#x3D; 0;i &lt; N;i ++)&#123;</span><br><span class="line">        for(int j &#x3D; 0;j &lt; N;j ++)&#123;</span><br><span class="line">            if(a[i][j] !&#x3D; b[i][j]) return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br><span class="line">int evalute(int state[N][N],int target[N][N])&#123;</span><br><span class="line">    int num &#x3D; 0;</span><br><span class="line">    for(int i &#x3D; 0;i &lt; N;i ++)&#123;</span><br><span class="line">        for(int j &#x3D; 0;j &lt; N;j ++)</span><br><span class="line">            if(state[i][j] !&#x3D; target[i][j]) num ++;</span><br><span class="line">    &#125;</span><br><span class="line">    return num;</span><br><span class="line">&#125;</span><br><span class="line">void findBrack(int a[N][N],int x,int y)&#123;</span><br><span class="line">    for(int i &#x3D; 0;i &lt; N;i ++)&#123;</span><br><span class="line">        for(int j &#x3D; 0;j &lt; N;j ++)&#123;</span><br><span class="line">            if(a[i][j] &#x3D;&#x3D; 0) &#123;</span><br><span class="line">                x &#x3D; i;y &#x3D; j;return;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">bool move(int a[N][N],int b[N][N],int dir)&#123;</span><br><span class="line">    &#x2F;&#x2F;1 up 2 down 3 left 4 right</span><br><span class="line">    int x &#x3D; 0,y &#x3D; 0;</span><br><span class="line">    for(int i &#x3D; 0;i &lt; N;i ++)&#123;</span><br><span class="line">        for(int j &#x3D; 0;j &lt; N;j ++)&#123;</span><br><span class="line">            b[i][j] &#x3D; a[i][j];</span><br><span class="line">            if(a[i][j] &#x3D;&#x3D; 0) &#123;</span><br><span class="line">                x &#x3D; i;y &#x3D; j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if(x &#x3D;&#x3D; 0 &amp;&amp; dir &#x3D;&#x3D; 1) return false;</span><br><span class="line">    if(x &#x3D;&#x3D; N-1 &amp;&amp; dir &#x3D;&#x3D; 2) return false;</span><br><span class="line">    if(y &#x3D;&#x3D; 0 &amp;&amp; dir &#x3D;&#x3D; 3) return false;</span><br><span class="line">    if(y &#x3D;&#x3D; N-1 &amp;&amp; dir &#x3D;&#x3D; 4) return false;</span><br><span class="line">    if(dir &#x3D;&#x3D; 1)&#123;b[x-1][y] &#x3D; 0;b[x][y] &#x3D; a[x-1][y];&#125;</span><br><span class="line">    else if(dir &#x3D;&#x3D; 2)&#123;b[x+1][y] &#x3D; 0;b[x][y] &#x3D; a[x+1][y];&#125;</span><br><span class="line">    else if(dir &#x3D;&#x3D; 3)&#123;b[x][y-1] &#x3D; 0;b[x][y] &#x3D; a[x][y-1];&#125;</span><br><span class="line">    else if(dir &#x3D;&#x3D; 4)&#123;b[x][y+1] &#x3D; 0;b[x][y] &#x3D; a[x][y+1];&#125;</span><br><span class="line">    else return false;</span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br><span class="line">void statecpy(int a[N][N][maxState],int b[N][N],int n)&#123;</span><br><span class="line">    for(int i &#x3D; 0;i &lt; N;i ++)&#123;</span><br><span class="line">        for(int j &#x3D; 0;j &lt; N;j ++)&#123;</span><br><span class="line">            a[i][j][n] &#x3D; b[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">void getState(int a[N][N][maxState],int b[N][N],int n)&#123;</span><br><span class="line">    for(int i &#x3D; 0;i &lt; N;i ++)&#123;</span><br><span class="line">        for(int j &#x3D; 0;j &lt; N;j ++)&#123;</span><br><span class="line">            b[i][j] &#x3D; a[i][j][n];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">void statecpy(int a[N][N],int b[N][N])&#123;</span><br><span class="line">    for(int i &#x3D; 0;i &lt; N;i++)&#123;</span><br><span class="line">        for(int j &#x3D; 0;j &lt; N;j++)</span><br><span class="line">            a[i][j] &#x3D; b[i][j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">int checkAdd(int a[N][N][maxState],int b[N][N],int n)&#123;</span><br><span class="line">    for(int i &#x3D; 0;i &lt; n;i ++)&#123;</span><br><span class="line">        if(isEqual(a,b,i)) return i;</span><br><span class="line">    &#125;</span><br><span class="line">    return -1;</span><br><span class="line">&#125;</span><br><span class="line">int Astar(int a[N][N][maxState],int start[N][N],int target[N][N],int path[maxState])&#123;</span><br><span class="line">    bool visited[maxState] &#x3D; &#123;false&#125;;</span><br><span class="line">    int fitness[maxState] &#x3D; &#123;0&#125;;</span><br><span class="line">    int passLen[maxState] &#x3D; &#123;0&#125;;</span><br><span class="line">    int curpos[N][N];</span><br><span class="line">    statecpy(curpos,start);</span><br><span class="line">    int id &#x3D; 0,Curid &#x3D; 0;</span><br><span class="line">    fitness[id] &#x3D; evalute(curpos,target);</span><br><span class="line">    statecpy(a,start,id++);</span><br><span class="line">    while(!isEqual(curpos,target))&#123;</span><br><span class="line">        for(int i &#x3D; 1;i &lt; 5;i ++)&#123;&#x2F;&#x2F;向四周找方向</span><br><span class="line">            int tmp[N][N] &#x3D; &#123;0&#125;;</span><br><span class="line">            if(move(curpos,tmp,i))&#123;</span><br><span class="line">                int state &#x3D; checkAdd(a,tmp,id);</span><br><span class="line">                if(state &#x3D;&#x3D; -1)&#123;&#x2F;&#x2F;not add</span><br><span class="line">                    path[id] &#x3D; Curid;</span><br><span class="line">                    passLen[id] &#x3D; passLen[Curid] + 1;</span><br><span class="line">                    fitness[id] &#x3D; evalute(tmp,target) + passLen[id];</span><br><span class="line">                    statecpy(a,tmp,id++);</span><br><span class="line">                &#125;else&#123;&#x2F;&#x2F;add</span><br><span class="line">                    int len &#x3D; passLen[Curid] + 1,fit &#x3D; evalute(tmp,target) + len;</span><br><span class="line">                    if(fit &lt; fitness[state])&#123;</span><br><span class="line">                        path[state] &#x3D; Curid;</span><br><span class="line">                        passLen[state] &#x3D; len;</span><br><span class="line">                        fitness[state] &#x3D; fit;</span><br><span class="line">                        visited[state] &#x3D; false;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        visited[Curid] &#x3D; true;</span><br><span class="line">        &#x2F;&#x2F;找到适应度最小的最为下一个带搜索节点</span><br><span class="line">        int minCur &#x3D; -1;</span><br><span class="line">        for(int i &#x3D; 0;i &lt; id;i ++)</span><br><span class="line">            if(!visited[i] &amp;&amp; (minCur &#x3D;&#x3D; -1 || fitness[i] &lt; fitness[minCur])) minCur &#x3D; i;</span><br><span class="line">        Curid &#x3D; minCur;</span><br><span class="line">        getState(a,curpos,Curid);</span><br><span class="line">        if(id &#x3D;&#x3D; maxState) return -1;</span><br><span class="line">    &#125;</span><br><span class="line">    return Curid;</span><br><span class="line">&#125;</span><br><span class="line">void show(int a[N][N][maxState],int n)&#123;</span><br><span class="line">    cout &lt;&lt; &quot;-------------------------------\n&quot;;</span><br><span class="line">    for(int i &#x3D; 0;i &lt; N;i ++)&#123;</span><br><span class="line">        for(int j &#x3D;0;j &lt; N;j ++)&#123;</span><br><span class="line">            cout &lt;&lt; a[i][j][n] &lt;&lt; &quot; &quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; &quot;-------------------------------\n&quot;;</span><br><span class="line">&#125;</span><br><span class="line">int calDe(int a[N][N])&#123;</span><br><span class="line">    int sum &#x3D; 0;</span><br><span class="line">    for(int i &#x3D; 0;i &lt; N*N;i ++)&#123;</span><br><span class="line">        for(int j &#x3D; i+1;j &lt; N*N;j ++)&#123;</span><br><span class="line">            int m,n,c,d;</span><br><span class="line">            m &#x3D; i&#x2F;N;n &#x3D; i%N;</span><br><span class="line">            c &#x3D; j&#x2F;N;d &#x3D; j%N;</span><br><span class="line">            if(a[c][d] &#x3D;&#x3D; 0) continue;</span><br><span class="line">            if(a[m][n] &gt; a[c][d]) sum ++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return sum;</span><br><span class="line">&#125;</span><br><span class="line">void autoGenerate(int a[N][N])&#123;</span><br><span class="line">    int maxMove &#x3D; 50;</span><br><span class="line">    srand((unsigned)time(NULL));</span><br><span class="line">    int tmp[N][N];</span><br><span class="line">    while(maxMove --)&#123;</span><br><span class="line">        int dir &#x3D; rand()%4 + 1;</span><br><span class="line">        if(move(a,tmp,dir)) statecpy(a,tmp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">int main()&#123;</span><br><span class="line">    int a[N][N][maxState] &#x3D; &#123;0&#125;;</span><br><span class="line">    &#x2F;&#x2F; int start[N][N] &#x3D; &#123;1,2,3,4,5,6,7,8,0&#125;;</span><br><span class="line">    &#x2F;&#x2F; autoGenerate(start);</span><br><span class="line">    &#x2F;&#x2F; cout &lt;&lt; start[0][0] &lt;&lt; start[1][1];</span><br><span class="line">    int start[N][N] &#x3D; &#123;4, 0, 3, 7, 2, 6, 8, 1, 5&#125;;</span><br><span class="line">    int target[N][N] &#x3D; &#123;1,2,3,4,5,6,7,8,0&#125;;</span><br><span class="line">    if(!(calDe(start)%2 &#x3D;&#x3D; calDe(target)%2))&#123;</span><br><span class="line">        cout &lt;&lt; &quot;无解\n&quot;;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">    int path[maxState] &#x3D; &#123;0&#125;;</span><br><span class="line">    int res &#x3D;  Astar(a,start,target,path);</span><br><span class="line">    if(res &#x3D;&#x3D; -1)&#123;</span><br><span class="line">        cout &lt;&lt; &quot;达到最大搜索能力\n&quot;;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">    int shortest[maxState] &#x3D; &#123;0&#125;,j &#x3D; 0;</span><br><span class="line">    while(res !&#x3D; 0)&#123;</span><br><span class="line">        shortest[j++] &#x3D; res;</span><br><span class="line">        res &#x3D; path[res];</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; &quot;第 0 步\n&quot;;</span><br><span class="line">    show(a,0);</span><br><span class="line">    for(int i &#x3D; j - 1;i &gt;&#x3D; 0;i --)&#123;</span><br><span class="line">        cout &lt;&lt; &quot;第 &quot; &lt;&lt; j-i &lt;&lt; &quot; 步\n&quot;;</span><br><span class="line">        show(a,shortest[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;884226886224488</span><br></pre></td></tr></table></figure>

<p>base64换表求解</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">b64table &#x3D; &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&#39;</span><br><span class="line"></span><br><span class="line">def b64encode(src, table):</span><br><span class="line"></span><br><span class="line">if len(table) !&#x3D; 64:</span><br><span class="line">return &#39;Table length error&#39;</span><br><span class="line"></span><br><span class="line">return base64.b64encode(src.encode()).decode().translate(</span><br><span class="line">str.maketrans(b64table, table))</span><br><span class="line">a &#x3D; b64encode(&#39;884226886224488&#39;,&#39;uvwxyz0123456789+&#x2F;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrst&#39;)</span><br><span class="line">print(&#39;flag&#123;%s&#125;&#39; % a)</span><br></pre></td></tr></table></figure>

<p>flag{8xOi6R2k8xOk6R2i7xOm}</p>
<h2 id="鲲鹏计算-amp-amp-鸿蒙专场-RealWorld"><a href="#鲲鹏计算-amp-amp-鸿蒙专场-RealWorld" class="headerlink" title="鲲鹏计算 &amp;&amp; 鸿蒙专场 - RealWorld"></a>鲲鹏计算 &amp;&amp; 鸿蒙专场 - RealWorld</h2><p>realworld这几道都比较简单，有手就行</p>
<h3 id="AESbaby"><a href="#AESbaby" class="headerlink" title="AESbaby"></a><strong>AESbaby</strong></h3><p>arm架构，买个鲲鹏处理器的云服务器编译即可 </p>
<p>抄个aes，table优化成52/62，百分之五十概率能打通，分段传shellcode，exp打通概率百分之二十左右</p>
<h4 id="远程exp"><a href="#远程exp" class="headerlink" title="远程exp"></a>远程exp</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">from base64 import *</span><br><span class="line">from pwn import *</span><br><span class="line">from hashlib import md5</span><br><span class="line">import string</span><br><span class="line">context.log_level&#x3D;&quot;debug&quot;</span><br><span class="line">def crackmd5(pre):</span><br><span class="line">    table &#x3D; string.ascii_letters+string.digits</span><br><span class="line">for i in range(62):</span><br><span class="line">for j in range(62):</span><br><span class="line">for k in range(62):</span><br><span class="line">for z in range(62):</span><br><span class="line">                    post &#x3D; table[i]+table[j]+table[k]+table[z]</span><br><span class="line">                    tmp &#x3D; pre+post</span><br><span class="line"># </span><br><span class="line">if md5(tmp).hexdigest().startswith(&#39;0&#39;*6):</span><br><span class="line">print(&#39;get&#39;)</span><br><span class="line">print(tmp)</span><br><span class="line">return post</span><br><span class="line">print(&quot;error&quot;)</span><br><span class="line">return &#39;error&#39;</span><br><span class="line"></span><br><span class="line">p &#x3D; remote(&#39;139.159.190.149&#39;,10000)</span><br><span class="line">p.recvuntil(b&#39;md5(&#39;)</span><br><span class="line">pre &#x3D; p.recvuntil(b&#39;+&#39;)[:-1]</span><br><span class="line">print (&#39;pre -&gt; &#39;,pre)</span><br><span class="line"></span><br><span class="line">p.send(crackmd5(pre))</span><br><span class="line">p.sendline(&#39;&#39;)</span><br><span class="line">sleep(1)</span><br><span class="line">print (p.recvuntil(b&#39;base64:&#39;)</span><br><span class="line">)</span><br><span class="line">sleep(1)</span><br><span class="line">with open(&#39;.&#x2F;a.out&#39;,&#39;rb&#39;) as r:</span><br><span class="line">    a &#x3D; r.read()</span><br><span class="line">    c &#x3D; b64encode(a)</span><br><span class="line">for i in range(0,len(c)&#x2F;1024):</span><br><span class="line">        p.send(c[i*1024:(i+1)*1024])</span><br><span class="line">if len(c)%1024 !&#x3D;0:</span><br><span class="line">        p.sendline(c[(len(c)&#x2F;1024)*1024:])</span><br><span class="line">print(len(c))</span><br><span class="line">print(len(c)&#x2F;1024)</span><br><span class="line">sleep(50)</span><br><span class="line">print p.recvuntil(&quot;&#125;&quot;)</span><br></pre></td></tr></table></figure>

<h4 id="可执行文件源码"><a href="#可执行文件源码" class="headerlink" title="可执行文件源码"></a>可执行文件源码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Advanced Encryption Standard</span><br><span class="line"> * @author Dani Huertas</span><br><span class="line"> * @email huertas.dani@gmail.com</span><br><span class="line"> *</span><br><span class="line"> * Based on the document FIPS PUB 197</span><br><span class="line"> *&#x2F;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stddef.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">&#x2F;*</span><br><span class="line"> * Addition in GF(2^8)</span><br><span class="line"> * http:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Finite_field_arithmetic</span><br><span class="line"> *&#x2F;</span><br><span class="line">uint8_t gadd(uint8_t a, uint8_t b) &#123;</span><br><span class="line">return a ^ b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Subtraction in GF(2^8)</span><br><span class="line"> * http:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Finite_field_arithmetic</span><br><span class="line"> *&#x2F;</span><br><span class="line">uint8_t gsub(uint8_t a, uint8_t b) &#123;</span><br><span class="line">return a ^ b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Multiplication in GF(2^8)</span><br><span class="line"> * http:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Finite_field_arithmetic</span><br><span class="line"> * Irreducible polynomial m(x) &#x3D; x8 + x4 + x3 + x + 1</span><br><span class="line"> *</span><br><span class="line"> * NOTE: This function can be easily replaced with a look up table for a speed</span><br><span class="line"> *       boost, at the expense of an increase in memory size (around 65 KB).</span><br><span class="line"> *&#x2F;</span><br><span class="line">uint8_t gmult(uint8_t a, uint8_t b) &#123;</span><br><span class="line">uint8_t p &#x3D; 0, i &#x3D; 0, hbs &#x3D; 0;</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0; i &lt; 8; i++) &#123;</span><br><span class="line">if (b &amp; 1) &#123;</span><br><span class="line">      p ^&#x3D; a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    hbs &#x3D; a &amp; 0x80;</span><br><span class="line">    a &lt;&lt;&#x3D; 1;</span><br><span class="line">if (hbs)</span><br><span class="line">      a ^&#x3D; 0x1b;  &#x2F;&#x2F; 0000 0001 0001 1011</span><br><span class="line">    b &gt;&gt;&#x3D; 1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">return (uint8_t)p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Addition of 4 byte words</span><br><span class="line"> * m(x) &#x3D; x4+1</span><br><span class="line"> *&#x2F;</span><br><span class="line">void coef_add(uint8_t a[], uint8_t b[], uint8_t d[]) &#123;</span><br><span class="line">d[0] &#x3D; a[0] ^ b[0];</span><br><span class="line">d[1] &#x3D; a[1] ^ b[1];</span><br><span class="line">d[2] &#x3D; a[2] ^ b[2];</span><br><span class="line">d[3] &#x3D; a[3] ^ b[3];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Multiplication of 4 byte words</span><br><span class="line"> * m(x) &#x3D; x4+1</span><br><span class="line"> *&#x2F;</span><br><span class="line">void coef_mult(uint8_t* a, uint8_t* b, uint8_t* d) &#123;</span><br><span class="line">d[0] &#x3D; gmult(a[0], b[0]) ^ gmult(a[3], b[1]) ^ gmult(a[2], b[2]) ^</span><br><span class="line">gmult(a[1], b[3]);</span><br><span class="line">d[1] &#x3D; gmult(a[1], b[0]) ^ gmult(a[0], b[1]) ^ gmult(a[3], b[2]) ^</span><br><span class="line">gmult(a[2], b[3]);</span><br><span class="line">d[2] &#x3D; gmult(a[2], b[0]) ^ gmult(a[1], b[1]) ^ gmult(a[0], b[2]) ^</span><br><span class="line">gmult(a[3], b[3]);</span><br><span class="line">d[3] &#x3D; gmult(a[3], b[0]) ^ gmult(a[2], b[1]) ^ gmult(a[1], b[2]) ^</span><br><span class="line">gmult(a[0], b[3]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * The cipher Key.</span><br><span class="line"> *&#x2F;</span><br><span class="line">int K;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Number of columns (32-bit words) comprising the State. For this</span><br><span class="line"> * standard, Nb &#x3D; 4.</span><br><span class="line"> *&#x2F;</span><br><span class="line">int Nb &#x3D; 4;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Number of 32-bit words comprising the Cipher Key. For this</span><br><span class="line"> * standard, Nk &#x3D; 4, 6, or 8.</span><br><span class="line"> *&#x2F;</span><br><span class="line">int Nk;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Number of rounds, which is a function of  Nk  and  Nb (which is</span><br><span class="line"> * fixed). For this standard, Nr &#x3D; 10, 12, or 14.</span><br><span class="line"> *&#x2F;</span><br><span class="line">int Nr;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * S-box transformation table</span><br><span class="line"> *&#x2F;</span><br><span class="line">static uint8_t s_box[256] &#x3D; &#123;</span><br><span class="line">&#x2F;&#x2F; 0     1     2     3     4     5     6     7     8     9     a     b     c</span><br><span class="line">&#x2F;&#x2F; d     e     f</span><br><span class="line">0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5,</span><br><span class="line">0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76,  &#x2F;&#x2F; 0</span><br><span class="line">0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0,</span><br><span class="line">0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0,  &#x2F;&#x2F; 1</span><br><span class="line">0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc,</span><br><span class="line">0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15,  &#x2F;&#x2F; 2</span><br><span class="line">0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a,</span><br><span class="line">0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75,  &#x2F;&#x2F; 3</span><br><span class="line">0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0,</span><br><span class="line">0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84,  &#x2F;&#x2F; 4</span><br><span class="line">0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b,</span><br><span class="line">0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf,  &#x2F;&#x2F; 5</span><br><span class="line">0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85,</span><br><span class="line">0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8,  &#x2F;&#x2F; 6</span><br><span class="line">0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5,</span><br><span class="line">0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2,  &#x2F;&#x2F; 7</span><br><span class="line">0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17,</span><br><span class="line">0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73,  &#x2F;&#x2F; 8</span><br><span class="line">0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88,</span><br><span class="line">0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb,  &#x2F;&#x2F; 9</span><br><span class="line">0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c,</span><br><span class="line">0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79,  &#x2F;&#x2F; a</span><br><span class="line">0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9,</span><br><span class="line">0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08,  &#x2F;&#x2F; b</span><br><span class="line">0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6,</span><br><span class="line">0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a,  &#x2F;&#x2F; c</span><br><span class="line">0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e,</span><br><span class="line">0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e,  &#x2F;&#x2F; d</span><br><span class="line">0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94,</span><br><span class="line">0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf,  &#x2F;&#x2F; e</span><br><span class="line">0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68,</span><br><span class="line">0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16&#125;;  &#x2F;&#x2F; f</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Inverse S-box transformation table</span><br><span class="line"> *&#x2F;</span><br><span class="line">static uint8_t inv_s_box[256] &#x3D; &#123;</span><br><span class="line">&#x2F;&#x2F; 0     1     2     3     4     5     6     7     8     9     a     b     c</span><br><span class="line">&#x2F;&#x2F; d     e     f</span><br><span class="line">0x52, 0x09, 0x6a, 0xd5, 0x30, 0x36, 0xa5, 0x38,</span><br><span class="line">0xbf, 0x40, 0xa3, 0x9e, 0x81, 0xf3, 0xd7, 0xfb,  &#x2F;&#x2F; 0</span><br><span class="line">0x7c, 0xe3, 0x39, 0x82, 0x9b, 0x2f, 0xff, 0x87,</span><br><span class="line">0x34, 0x8e, 0x43, 0x44, 0xc4, 0xde, 0xe9, 0xcb,  &#x2F;&#x2F; 1</span><br><span class="line">0x54, 0x7b, 0x94, 0x32, 0xa6, 0xc2, 0x23, 0x3d,</span><br><span class="line">0xee, 0x4c, 0x95, 0x0b, 0x42, 0xfa, 0xc3, 0x4e,  &#x2F;&#x2F; 2</span><br><span class="line">0x08, 0x2e, 0xa1, 0x66, 0x28, 0xd9, 0x24, 0xb2,</span><br><span class="line">0x76, 0x5b, 0xa2, 0x49, 0x6d, 0x8b, 0xd1, 0x25,  &#x2F;&#x2F; 3</span><br><span class="line">0x72, 0xf8, 0xf6, 0x64, 0x86, 0x68, 0x98, 0x16,</span><br><span class="line">0xd4, 0xa4, 0x5c, 0xcc, 0x5d, 0x65, 0xb6, 0x92,  &#x2F;&#x2F; 4</span><br><span class="line">0x6c, 0x70, 0x48, 0x50, 0xfd, 0xed, 0xb9, 0xda,</span><br><span class="line">0x5e, 0x15, 0x46, 0x57, 0xa7, 0x8d, 0x9d, 0x84,  &#x2F;&#x2F; 5</span><br><span class="line">0x90, 0xd8, 0xab, 0x00, 0x8c, 0xbc, 0xd3, 0x0a,</span><br><span class="line">0xf7, 0xe4, 0x58, 0x05, 0xb8, 0xb3, 0x45, 0x06,  &#x2F;&#x2F; 6</span><br><span class="line">0xd0, 0x2c, 0x1e, 0x8f, 0xca, 0x3f, 0x0f, 0x02,</span><br><span class="line">0xc1, 0xaf, 0xbd, 0x03, 0x01, 0x13, 0x8a, 0x6b,  &#x2F;&#x2F; 7</span><br><span class="line">0x3a, 0x91, 0x11, 0x41, 0x4f, 0x67, 0xdc, 0xea,</span><br><span class="line">0x97, 0xf2, 0xcf, 0xce, 0xf0, 0xb4, 0xe6, 0x73,  &#x2F;&#x2F; 8</span><br><span class="line">0x96, 0xac, 0x74, 0x22, 0xe7, 0xad, 0x35, 0x85,</span><br><span class="line">0xe2, 0xf9, 0x37, 0xe8, 0x1c, 0x75, 0xdf, 0x6e,  &#x2F;&#x2F; 9</span><br><span class="line">0x47, 0xf1, 0x1a, 0x71, 0x1d, 0x29, 0xc5, 0x89,</span><br><span class="line">0x6f, 0xb7, 0x62, 0x0e, 0xaa, 0x18, 0xbe, 0x1b,  &#x2F;&#x2F; a</span><br><span class="line">0xfc, 0x56, 0x3e, 0x4b, 0xc6, 0xd2, 0x79, 0x20,</span><br><span class="line">0x9a, 0xdb, 0xc0, 0xfe, 0x78, 0xcd, 0x5a, 0xf4,  &#x2F;&#x2F; b</span><br><span class="line">0x1f, 0xdd, 0xa8, 0x33, 0x88, 0x07, 0xc7, 0x31,</span><br><span class="line">0xb1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xec, 0x5f,  &#x2F;&#x2F; c</span><br><span class="line">0x60, 0x51, 0x7f, 0xa9, 0x19, 0xb5, 0x4a, 0x0d,</span><br><span class="line">0x2d, 0xe5, 0x7a, 0x9f, 0x93, 0xc9, 0x9c, 0xef,  &#x2F;&#x2F; d</span><br><span class="line">0xa0, 0xe0, 0x3b, 0x4d, 0xae, 0x2a, 0xf5, 0xb0,</span><br><span class="line">0xc8, 0xeb, 0xbb, 0x3c, 0x83, 0x53, 0x99, 0x61,  &#x2F;&#x2F; e</span><br><span class="line">0x17, 0x2b, 0x04, 0x7e, 0xba, 0x77, 0xd6, 0x26,</span><br><span class="line">0xe1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0c, 0x7d&#125;;  &#x2F;&#x2F; f</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Generates the round constant Rcon[i]</span><br><span class="line"> *&#x2F;</span><br><span class="line">uint8_t R[] &#x3D; &#123;0x02, 0x00, 0x00, 0x00&#125;;</span><br><span class="line"></span><br><span class="line">uint8_t* Rcon(uint8_t i) &#123;</span><br><span class="line">if (i &#x3D;&#x3D; 1) &#123;</span><br><span class="line">R[0] &#x3D; 0x01;  &#x2F;&#x2F; x^(1-1) &#x3D; x^0 &#x3D; 1</span><br><span class="line">  &#125; else if (i &gt; 1) &#123;</span><br><span class="line">R[0] &#x3D; 0x02;</span><br><span class="line">    i--;</span><br><span class="line">while (i - 1 &gt; 0) &#123;</span><br><span class="line">R[0] &#x3D; gmult(R[0], 0x02);</span><br><span class="line">      i--;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">return R;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Transformation in the Cipher and Inverse Cipher in which a Round</span><br><span class="line"> * Key is added to the State using an XOR operation. The length of a</span><br><span class="line"> * Round Key equals the size of the State (i.e., for Nb &#x3D; 4, the Round</span><br><span class="line"> * Key length equals 128 bits&#x2F;16 bytes).</span><br><span class="line"> *&#x2F;</span><br><span class="line">void add_round_key(uint8_t* state, uint8_t* w, uint8_t r) &#123;</span><br><span class="line">uint8_t c;</span><br><span class="line"></span><br><span class="line">for (c &#x3D; 0; c &lt; Nb; c++) &#123;</span><br><span class="line">state[Nb * 0 + c] &#x3D;</span><br><span class="line">state[Nb * 0 + c] ^</span><br><span class="line">w[4 * Nb * r + 4 * c + 0];  &#x2F;&#x2F; debug, so it works for Nb !&#x3D;4</span><br><span class="line">state[Nb * 1 + c] &#x3D; state[Nb * 1 + c] ^ w[4 * Nb * r + 4 * c + 1];</span><br><span class="line">state[Nb * 2 + c] &#x3D; state[Nb * 2 + c] ^ w[4 * Nb * r + 4 * c + 2];</span><br><span class="line">state[Nb * 3 + c] &#x3D; state[Nb * 3 + c] ^ w[4 * Nb * r + 4 * c + 3];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Transformation in the Cipher that takes all of the columns of the</span><br><span class="line"> * State and mixes their data (independently of one another) to</span><br><span class="line"> * produce new columns.</span><br><span class="line"> *&#x2F;</span><br><span class="line">void mix_columns(uint8_t* state) &#123;</span><br><span class="line">uint8_t a[] &#x3D; &#123;0x02, 0x01, 0x01,</span><br><span class="line">0x03&#125;;  &#x2F;&#x2F; a(x) &#x3D; &#123;02&#125; + &#123;01&#125;x + &#123;01&#125;x2 + &#123;03&#125;x3</span><br><span class="line">uint8_t i, j, col[4], res[4];</span><br><span class="line"></span><br><span class="line">for (j &#x3D; 0; j &lt; Nb; j++) &#123;</span><br><span class="line">for (i &#x3D; 0; i &lt; 4; i++) &#123;</span><br><span class="line">col[i] &#x3D; state[Nb * i + j];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">coef_mult(a, col, res);</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0; i &lt; 4; i++) &#123;</span><br><span class="line">state[Nb * i + j] &#x3D; res[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Transformation in the Inverse Cipher that is the inverse of</span><br><span class="line"> * MixColumns().</span><br><span class="line"> *&#x2F;</span><br><span class="line">void inv_mix_columns(uint8_t* state) &#123;</span><br><span class="line">uint8_t a[] &#x3D; &#123;0x0e, 0x09, 0x0d,</span><br><span class="line">0x0b&#125;;  &#x2F;&#x2F; a(x) &#x3D; &#123;0e&#125; + &#123;09&#125;x + &#123;0d&#125;x2 + &#123;0b&#125;x3</span><br><span class="line">uint8_t i, j, col[4], res[4];</span><br><span class="line"></span><br><span class="line">for (j &#x3D; 0; j &lt; Nb; j++) &#123;</span><br><span class="line">for (i &#x3D; 0; i &lt; 4; i++) &#123;</span><br><span class="line">col[i] &#x3D; state[Nb * i + j];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">coef_mult(a, col, res);</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0; i &lt; 4; i++) &#123;</span><br><span class="line">state[Nb * i + j] &#x3D; res[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Transformation in the Cipher that processes the State by cyclically</span><br><span class="line"> * shifting the last three rows of the State by different offsets.</span><br><span class="line"> *&#x2F;</span><br><span class="line">void shift_rows(uint8_t* state) &#123;</span><br><span class="line">uint8_t i, k, s, tmp;</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 1; i &lt; 4; i++) &#123;</span><br><span class="line">&#x2F;&#x2F; shift(1,4)&#x3D;1; shift(2,4)&#x3D;2; shift(3,4)&#x3D;3</span><br><span class="line">&#x2F;&#x2F; shift(r, 4) &#x3D; r;</span><br><span class="line">    s &#x3D; 0;</span><br><span class="line">while (s &lt; i) &#123;</span><br><span class="line">      tmp &#x3D; state[Nb * i + 0];</span><br><span class="line"></span><br><span class="line">for (k &#x3D; 1; k &lt; Nb; k++) &#123;</span><br><span class="line">state[Nb * i + k - 1] &#x3D; state[Nb * i + k];</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">state[Nb * i + Nb - 1] &#x3D; tmp;</span><br><span class="line">      s++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Transformation in the Inverse Cipher that is the inverse of</span><br><span class="line"> * ShiftRows().</span><br><span class="line"> *&#x2F;</span><br><span class="line">void inv_shift_rows(uint8_t* state) &#123;</span><br><span class="line">uint8_t i, k, s, tmp;</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 1; i &lt; 4; i++) &#123;</span><br><span class="line">    s &#x3D; 0;</span><br><span class="line">while (s &lt; i) &#123;</span><br><span class="line">      tmp &#x3D; state[Nb * i + Nb - 1];</span><br><span class="line"></span><br><span class="line">for (k &#x3D; Nb - 1; k &gt; 0; k--) &#123;</span><br><span class="line">state[Nb * i + k] &#x3D; state[Nb * i + k - 1];</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">state[Nb * i + 0] &#x3D; tmp;</span><br><span class="line">      s++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Transformation in the Cipher that processes the State using a non­</span><br><span class="line"> * linear byte substitution table (S-box) that operates on each of the</span><br><span class="line"> * State bytes independently.</span><br><span class="line"> *&#x2F;</span><br><span class="line">void sub_bytes(uint8_t* state) &#123;</span><br><span class="line">uint8_t i, j;</span><br><span class="line">uint8_t row, col;</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0; i &lt; 4; i++) &#123;</span><br><span class="line">for (j &#x3D; 0; j &lt; Nb; j++) &#123;</span><br><span class="line">      row &#x3D; (state[Nb * i + j] &amp; 0xf0) &gt;&gt; 4;</span><br><span class="line">      col &#x3D; state[Nb * i + j] &amp; 0x0f;</span><br><span class="line">state[Nb * i + j] &#x3D; s_box[16 * row + col];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Transformation in the Inverse Cipher that is the inverse of</span><br><span class="line"> * SubBytes().</span><br><span class="line"> *&#x2F;</span><br><span class="line">void inv_sub_bytes(uint8_t* state) &#123;</span><br><span class="line">uint8_t i, j;</span><br><span class="line">uint8_t row, col;</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0; i &lt; 4; i++) &#123;</span><br><span class="line">for (j &#x3D; 0; j &lt; Nb; j++) &#123;</span><br><span class="line">      row &#x3D; (state[Nb * i + j] &amp; 0xf0) &gt;&gt; 4;</span><br><span class="line">      col &#x3D; state[Nb * i + j] &amp; 0x0f;</span><br><span class="line">state[Nb * i + j] &#x3D; inv_s_box[16 * row + col];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Function used in the Key Expansion routine that takes a four-byte</span><br><span class="line"> * input word and applies an S-box to each of the four bytes to</span><br><span class="line"> * produce an output word.</span><br><span class="line"> *&#x2F;</span><br><span class="line">void sub_word(uint8_t* w) &#123;</span><br><span class="line">uint8_t i;</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0; i &lt; 4; i++) &#123;</span><br><span class="line">w[i] &#x3D; s_box[16 * ((w[i] &amp; 0xf0) &gt;&gt; 4) + (w[i] &amp; 0x0f)];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Function used in the Key Expansion routine that takes a four-byte</span><br><span class="line"> * word and performs a cyclic permutation.</span><br><span class="line"> *&#x2F;</span><br><span class="line">void rot_word(uint8_t* w) &#123;</span><br><span class="line">uint8_t tmp;</span><br><span class="line">uint8_t i;</span><br><span class="line"></span><br><span class="line">  tmp &#x3D; w[0];</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0; i &lt; 3; i++) &#123;</span><br><span class="line">w[i] &#x3D; w[i + 1];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">w[3] &#x3D; tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Key Expansion</span><br><span class="line"> *&#x2F;</span><br><span class="line">void aes_key_expansion(uint8_t* key, uint8_t* w) &#123;</span><br><span class="line">uint8_t tmp[4];</span><br><span class="line">uint8_t i, j;</span><br><span class="line">uint8_t len &#x3D; Nb * (Nr + 1);</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0; i &lt; Nk; i++) &#123;</span><br><span class="line">w[4 * i + 0] &#x3D; key[4 * i + 0];</span><br><span class="line">w[4 * i + 1] &#x3D; key[4 * i + 1];</span><br><span class="line">w[4 * i + 2] &#x3D; key[4 * i + 2];</span><br><span class="line">w[4 * i + 3] &#x3D; key[4 * i + 3];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">for (i &#x3D; Nk; i &lt; len; i++) &#123;</span><br><span class="line">tmp[0] &#x3D; w[4 * (i - 1) + 0];</span><br><span class="line">tmp[1] &#x3D; w[4 * (i - 1) + 1];</span><br><span class="line">tmp[2] &#x3D; w[4 * (i - 1) + 2];</span><br><span class="line">tmp[3] &#x3D; w[4 * (i - 1) + 3];</span><br><span class="line"></span><br><span class="line">if (i % Nk &#x3D;&#x3D; 0) &#123;</span><br><span class="line">rot_word(tmp);</span><br><span class="line">sub_word(tmp);</span><br><span class="line">coef_add(tmp, Rcon(i &#x2F; Nk), tmp);</span><br><span class="line"></span><br><span class="line">    &#125; else if (Nk &gt; 6 &amp;&amp; i % Nk &#x3D;&#x3D; 4) &#123;</span><br><span class="line">sub_word(tmp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">w[4 * i + 0] &#x3D; w[4 * (i - Nk) + 0] ^ tmp[0];</span><br><span class="line">w[4 * i + 1] &#x3D; w[4 * (i - Nk) + 1] ^ tmp[1];</span><br><span class="line">w[4 * i + 2] &#x3D; w[4 * (i - Nk) + 2] ^ tmp[2];</span><br><span class="line">w[4 * i + 3] &#x3D; w[4 * (i - Nk) + 3] ^ tmp[3];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Initialize AES variables and allocate memory for expanded key</span><br><span class="line"> *&#x2F;</span><br><span class="line">uint8_t* aes_init(size_t key_size) &#123;</span><br><span class="line">switch (key_size) &#123;</span><br><span class="line">default:</span><br><span class="line">case 16:</span><br><span class="line">      Nk &#x3D; 4;</span><br><span class="line">      Nr &#x3D; 10;</span><br><span class="line">break;</span><br><span class="line">case 24:</span><br><span class="line">      Nk &#x3D; 6;</span><br><span class="line">      Nr &#x3D; 12;</span><br><span class="line">break;</span><br><span class="line">case 32:</span><br><span class="line">      Nk &#x3D; 8;</span><br><span class="line">      Nr &#x3D; 14;</span><br><span class="line">break;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">return malloc(Nb * (Nr + 1) * 4);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Performs the AES cipher operation</span><br><span class="line"> *&#x2F;</span><br><span class="line">void aes_cipher(uint8_t* in, uint8_t* out, uint8_t* w) &#123;</span><br><span class="line">uint8_t state[4 * Nb];</span><br><span class="line">uint8_t r, i, j;</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0; i &lt; 4; i++) &#123;</span><br><span class="line">for (j &#x3D; 0; j &lt; Nb; j++) &#123;</span><br><span class="line">state[Nb * i + j] &#x3D; in[i + 4 * j];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">add_round_key(state, w, 0);</span><br><span class="line"></span><br><span class="line">for (r &#x3D; 1; r &lt; Nr; r++) &#123;</span><br><span class="line">sub_bytes(state);</span><br><span class="line">shift_rows(state);</span><br><span class="line">mix_columns(state);</span><br><span class="line">add_round_key(state, w, r);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">sub_bytes(state);</span><br><span class="line">shift_rows(state);</span><br><span class="line">add_round_key(state, w, Nr);</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0; i &lt; 4; i++) &#123;</span><br><span class="line">for (j &#x3D; 0; j &lt; Nb; j++) &#123;</span><br><span class="line">out[i + 4 * j] &#x3D; state[Nb * i + j];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"> * Performs the AES inverse cipher operation</span><br><span class="line"> *&#x2F;</span><br><span class="line">void aes_inv_cipher(uint8_t* in, uint8_t* out, uint8_t* w) &#123;</span><br><span class="line">uint8_t state[4 * Nb];</span><br><span class="line">uint8_t r, i, j;</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0; i &lt; 4; i++) &#123;</span><br><span class="line">for (j &#x3D; 0; j &lt; Nb; j++) &#123;</span><br><span class="line">state[Nb * i + j] &#x3D; in[i + 4 * j];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">add_round_key(state, w, Nr);</span><br><span class="line"></span><br><span class="line">for (r &#x3D; Nr - 1; r &gt;&#x3D; 1; r--) &#123;</span><br><span class="line">inv_shift_rows(state);</span><br><span class="line">inv_sub_bytes(state);</span><br><span class="line">add_round_key(state, w, r);</span><br><span class="line">inv_mix_columns(state);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">inv_shift_rows(state);</span><br><span class="line">inv_sub_bytes(state);</span><br><span class="line">add_round_key(state, w, 0);</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0; i &lt; 4; i++) &#123;</span><br><span class="line">for (j &#x3D; 0; j &lt; Nb; j++) &#123;</span><br><span class="line">out[i + 4 * j] &#x3D; state[Nb * i + j];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main(int argc, char* argv[]) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">char s[] &#x3D; &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;</span><br><span class="line">&#x2F;&#x2F; char s[] &#x3D; &quot;124&quot;;</span><br><span class="line">uint8_t buf[20];</span><br><span class="line">scanf(&quot;%12s&quot;,&amp;buf);</span><br><span class="line">uint8_t tmp[100];</span><br><span class="line">uint8_t cipher[16];</span><br><span class="line">scanf(&quot;%32s&quot;,&amp;tmp);</span><br><span class="line">for(int i&#x3D;0;i&lt;32;i++)&#123;</span><br><span class="line">if (tmp[i]&gt;0x40)&#123;</span><br><span class="line">tmp[i] -&#x3D; 0x57;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">tmp[i] -&#x3D;0x30;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">for(int i&#x3D;0;i&lt;32;i+&#x3D;2)&#123;</span><br><span class="line">cipher[i&#x2F;2] &#x3D; (tmp[i] &lt;&lt; 4) | tmp[i+1];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">for(int i &#x3D;0;i&lt;52;i++)&#123;</span><br><span class="line">for(int j &#x3D;0;j&lt;52;j++)&#123;</span><br><span class="line">for(int k &#x3D;0;k&lt;52;k++)&#123;</span><br><span class="line">for(int z &#x3D;0;z&lt;52;z++)&#123;</span><br><span class="line">buf[12] &#x3D; s[i];</span><br><span class="line">buf[13] &#x3D; s[j];</span><br><span class="line">buf[14] &#x3D; s[k];</span><br><span class="line">buf[15] &#x3D; s[z];</span><br><span class="line">buf[16] &#x3D; &#39;\x00&#39;;</span><br><span class="line">uint8_t* w;  &#x2F;&#x2F; expanded key</span><br><span class="line">                    w &#x3D; aes_init(sizeof(buf));</span><br><span class="line">aes_key_expansion(buf, w);</span><br><span class="line">uint8_t plain[16]&#x3D;&#123;0&#125;;</span><br><span class="line">aes_inv_cipher(cipher, plain, w);</span><br><span class="line">&#x2F;&#x2F; puts(plain);</span><br><span class="line">&#x2F;&#x2F; puts(buf);</span><br><span class="line">&#x2F;&#x2F; puts(plain);</span><br><span class="line">if(!strncmp(plain,&quot;KUNPENG_HPC_AES!&quot;,16))&#123;</span><br><span class="line">printf(&quot;%s&quot;,buf+12);</span><br><span class="line">return 0;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a><strong>Hash</strong></h3><p>老规矩，随便找个sha256源码，鲲鹏编译，大概百分之二的概率能出</p>
<h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">from base64 import *</span><br><span class="line">from pwn import *</span><br><span class="line">from hashlib import md5</span><br><span class="line">import string</span><br><span class="line">context.log_level&#x3D;&quot;debug&quot;</span><br><span class="line">def crackmd5(pre):</span><br><span class="line">    table &#x3D; string.ascii_letters+string.digits</span><br><span class="line">for i in range(62):</span><br><span class="line">for j in range(62):</span><br><span class="line">for k in range(62):</span><br><span class="line">for z in range(62):</span><br><span class="line">for m in range(62):</span><br><span class="line">                        post &#x3D; table[i]+table[j]+table[k]+table[z]+table[m]</span><br><span class="line">                        tmp &#x3D; pre+post</span><br><span class="line"># </span><br><span class="line">if md5(tmp).hexdigest().startswith(&#39;0&#39;*7):</span><br><span class="line">print(&#39;get&#39;)</span><br><span class="line">print(tmp)</span><br><span class="line">return post</span><br><span class="line">print(&quot;error&quot;)</span><br><span class="line">return &#39;error&#39;</span><br><span class="line"></span><br><span class="line">p &#x3D; remote(&#39;139.159.190.149&#39;,10002)</span><br><span class="line">p.recvuntil(b&#39;md5(&#39;)</span><br><span class="line">pre &#x3D; p.recvuntil(b&#39;+&#39;)[:-1]</span><br><span class="line">print (&#39;pre -&gt; &#39;,pre)</span><br><span class="line"></span><br><span class="line">p.send(crackmd5(pre))</span><br><span class="line">p.sendline(&#39;&#39;)</span><br><span class="line">sleep(1)</span><br><span class="line">print (p.recvuntil(b&#39;base64:&#39;))</span><br><span class="line">p.interactive()</span><br><span class="line"># sleep(1)</span><br><span class="line"># with open(&#39;.&#x2F;a.out&#39;,&#39;rb&#39;) as r:</span><br><span class="line">#     a &#x3D; r.read()</span><br><span class="line">#     c &#x3D; b64encode(a)</span><br><span class="line">#     for i in range(0,len(c)&#x2F;1024):</span><br><span class="line">#         p.send(c[i*1024:(i+1)*1024])</span><br><span class="line">#     if len(c)%1024 !&#x3D;0:</span><br><span class="line">#         p.sendline(c[(len(c)&#x2F;1024)*1024:])</span><br><span class="line">#     print(len(c))</span><br><span class="line">#     print(len(c)&#x2F;1024)</span><br><span class="line"># sleep(50)</span><br><span class="line"># print p.recvuntil(&quot;&#125;&quot;)</span><br></pre></td></tr></table></figure>

<h4 id="main-c"><a href="#main-c" class="headerlink" title="main.c"></a>main.c</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*********************************************************************</span><br><span class="line">* Filename:   sha256.c</span><br><span class="line">* Author:     Brad Conte (brad AT bradconte.com)</span><br><span class="line">* Copyright:</span><br><span class="line">* Disclaimer: This code is presented &quot;as is&quot; without any guarantees.</span><br><span class="line">* Details:    Performs known-answer tests on the corresponding SHA1</span><br><span class="line">              implementation. These tests do not encompass the full</span><br><span class="line">              range of available test vectors, however, if the tests</span><br><span class="line">              pass it is very, very likely that the code is correct</span><br><span class="line">              and was compiled properly. This code also serves as</span><br><span class="line">              example usage of the functions.</span><br><span class="line">*********************************************************************&#x2F;</span><br><span class="line"></span><br><span class="line">&#x2F;*************************** HEADER FILES ***************************&#x2F;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;memory.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &quot;sha256.h&quot;</span><br><span class="line"></span><br><span class="line">&#x2F;*********************** FUNCTION DEFINITIONS ***********************&#x2F;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    BYTE text1[20] &#x3D; &#123;0&#125;;</span><br><span class="line">scanf(&quot;%10s&quot;,&amp;text1);</span><br><span class="line">char s[] &#x3D; &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;;</span><br><span class="line">for(int i &#x3D;0;i&lt;62;i++)&#123;</span><br><span class="line">for(int j &#x3D;0;j&lt;62;j++)&#123;</span><br><span class="line">for(int k &#x3D;0;k&lt;62;k++)&#123;</span><br><span class="line">for(int m&#x3D;0;m&lt;62;m++)&#123;</span><br><span class="line">for(int z &#x3D;0;z&lt;62;z++)&#123;</span><br><span class="line">text1[10] &#x3D; s[i];</span><br><span class="line">text1[11] &#x3D; s[j];</span><br><span class="line">text1[12] &#x3D; s[k];</span><br><span class="line">text1[13] &#x3D; s[m];</span><br><span class="line">text1[14] &#x3D; s[z];</span><br><span class="line">text1[15] &#x3D; &#39;\x00&#39;;</span><br><span class="line">                        BYTE buf[SHA256_BLOCK_SIZE];</span><br><span class="line">                        SHA256_CTX ctx;</span><br><span class="line">int idx;</span><br><span class="line">int pass &#x3D; 1;</span><br><span class="line">sha256_init(&amp;ctx);</span><br><span class="line">sha256_update(&amp;ctx, text1, 15);</span><br><span class="line">sha256_final(&amp;ctx, buf);</span><br><span class="line">if(buf[0] &#x3D;&#x3D; 0 &amp;&amp; buf[1] &#x3D;&#x3D;0 &amp;&amp;buf[2] &#x3D;&#x3D; 0 &amp;&amp; ((buf[3] &gt;&gt; 2) &#x3D;&#x3D; 0))&#123;</span><br><span class="line">printf(&quot;%s&quot;,text1+10);</span><br><span class="line">return 0;</span><br><span class="line"></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; for(int i&#x3D;0;i&lt;32;i++)&#123;</span><br><span class="line">&#x2F;&#x2F;     printf(&quot;%02x&quot;,buf[i]&amp;0xff);</span><br><span class="line">&#x2F;&#x2F; &#125;</span><br><span class="line">return(0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="sha256-h"><a href="#sha256-h" class="headerlink" title="sha256.h"></a>sha256.h</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*********************************************************************</span><br><span class="line">* Filename:   sha256.h</span><br><span class="line">* Author:     Brad Conte (brad AT bradconte.com)</span><br><span class="line">* Copyright:</span><br><span class="line">* Disclaimer: This code is presented &quot;as is&quot; without any guarantees.</span><br><span class="line">* Details:    Defines the API for the corresponding SHA1 implementation.</span><br><span class="line">*********************************************************************&#x2F;</span><br><span class="line"></span><br><span class="line">#ifndef SHA256_H</span><br><span class="line">#define SHA256_H</span><br><span class="line"></span><br><span class="line">&#x2F;*************************** HEADER FILES ***************************&#x2F;</span><br><span class="line">#include &lt;stddef.h&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;****************************** MACROS ******************************&#x2F;</span><br><span class="line">#define SHA256_BLOCK_SIZE 32            &#x2F;&#x2F; SHA256 outputs a 32 byte digest</span><br><span class="line"></span><br><span class="line">&#x2F;**************************** DATA TYPES ****************************&#x2F;</span><br><span class="line">typedef unsigned char BYTE;             &#x2F;&#x2F; 8-bit byte</span><br><span class="line">typedef unsigned int  WORD;             &#x2F;&#x2F; 32-bit word, change to &quot;long&quot; for 16-bit machines</span><br><span class="line"></span><br><span class="line">typedef struct &#123;</span><br><span class="line">    BYTE data[64];</span><br><span class="line">    WORD datalen;</span><br><span class="line">unsigned long long bitlen;</span><br><span class="line">    WORD state[8];</span><br><span class="line">&#125; SHA256_CTX;</span><br><span class="line"></span><br><span class="line">&#x2F;*********************** FUNCTION DECLARATIONS **********************&#x2F;</span><br><span class="line">void sha256_init(SHA256_CTX *ctx);</span><br><span class="line">void sha256_update(SHA256_CTX *ctx, const BYTE data[], size_t len);</span><br><span class="line">void sha256_final(SHA256_CTX *ctx, BYTE hash[]);</span><br><span class="line"></span><br><span class="line">#endif   &#x2F;&#x2F; SHA256_H</span><br></pre></td></tr></table></figure>

<h4 id="sha256-c"><a href="#sha256-c" class="headerlink" title="sha256.c"></a>sha256.c</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*********************************************************************</span><br><span class="line">* Filename:   sha256.c</span><br><span class="line">* Author:     Brad Conte (brad AT bradconte.com)</span><br><span class="line">* Copyright:</span><br><span class="line">* Disclaimer: This codeis presented &quot;as is&quot; without any guarantees.</span><br><span class="line">* Details:    Implementation of the SHA-256 hashing algorithm.</span><br><span class="line">              SHA-256 is one of the three algorithms in the SHA2</span><br><span class="line">              specification. The others, SHA-384 and SHA-512, are not</span><br><span class="line">              offered in this implementation.</span><br><span class="line">              Algorithm specification can be found here:</span><br><span class="line">               * http:&#x2F;&#x2F;csrc.nist.gov&#x2F;publications&#x2F;fips&#x2F;fips180-2&#x2F;fips180-2withchangenotice.pdf</span><br><span class="line">              This implementation uses little endian byte order.</span><br><span class="line">*********************************************************************&#x2F;</span><br><span class="line"></span><br><span class="line">&#x2F;*************************** HEADER FILES ***************************&#x2F;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;memory.h&gt;</span><br><span class="line">#include &quot;sha256.h&quot;</span><br><span class="line"></span><br><span class="line">&#x2F;****************************** MACROS ******************************&#x2F;</span><br><span class="line">#define ROTLEFT(a,b) (((a) &lt;&lt; (b)) | ((a) &gt;&gt; (32-(b))))</span><br><span class="line">#define ROTRIGHT(a,b) (((a) &gt;&gt; (b)) | ((a) &lt;&lt; (32-(b))))</span><br><span class="line"></span><br><span class="line">#define CH(x,y,z) (((x) &amp; (y)) ^ (~(x) &amp; (z)))</span><br><span class="line">#define MAJ(x,y,z) (((x) &amp; (y)) ^ ((x) &amp; (z)) ^ ((y) &amp; (z)))</span><br><span class="line">#define EP0(x) (ROTRIGHT(x,2) ^ ROTRIGHT(x,13) ^ ROTRIGHT(x,22))</span><br><span class="line">#define EP1(x) (ROTRIGHT(x,6) ^ ROTRIGHT(x,11) ^ ROTRIGHT(x,25))</span><br><span class="line">#define SIG0(x) (ROTRIGHT(x,7) ^ ROTRIGHT(x,18) ^ ((x) &gt;&gt; 3))</span><br><span class="line">#define SIG1(x) (ROTRIGHT(x,17) ^ ROTRIGHT(x,19) ^ ((x) &gt;&gt; 10))</span><br><span class="line"></span><br><span class="line">&#x2F;**************************** VARIABLES *****************************&#x2F;</span><br><span class="line">static const WORD k[64] &#x3D; &#123;</span><br><span class="line">0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,</span><br><span class="line">0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,</span><br><span class="line">0xe49b69c1,0xefbe4786,0x0fc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,</span><br><span class="line">0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x06ca6351,0x14292967,</span><br><span class="line">0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,</span><br><span class="line">0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,</span><br><span class="line">0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,</span><br><span class="line">0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;*********************** FUNCTION DEFINITIONS ***********************&#x2F;</span><br><span class="line">void sha256_transform(SHA256_CTX *ctx, const BYTE data[])</span><br><span class="line">&#123;</span><br><span class="line">    WORD a, b, c, d, e, f, g, h, i, j, t1, t2, m[64];</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0, j &#x3D; 0; i &lt; 16; ++i, j +&#x3D; 4)</span><br><span class="line">m[i] &#x3D; (data[j] &lt;&lt; 24) | (data[j + 1] &lt;&lt; 16) | (data[j + 2] &lt;&lt; 8) | (data[j + 3]);</span><br><span class="line">for ( ; i &lt; 64; ++i)</span><br><span class="line">m[i] &#x3D; SIG1(m[i - 2]) + m[i - 7] + SIG0(m[i - 15]) + m[i - 16];</span><br><span class="line"></span><br><span class="line">    a &#x3D; ctx-&gt;state[0];</span><br><span class="line">    b &#x3D; ctx-&gt;state[1];</span><br><span class="line">    c &#x3D; ctx-&gt;state[2];</span><br><span class="line">    d &#x3D; ctx-&gt;state[3];</span><br><span class="line">    e &#x3D; ctx-&gt;state[4];</span><br><span class="line">    f &#x3D; ctx-&gt;state[5];</span><br><span class="line">    g &#x3D; ctx-&gt;state[6];</span><br><span class="line">    h &#x3D; ctx-&gt;state[7];</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0; i &lt; 64; ++i) &#123;</span><br><span class="line">        t1 &#x3D; h + EP1(e) + CH(e,f,g) + k[i] + m[i];</span><br><span class="line">        t2 &#x3D; EP0(a) + MAJ(a,b,c);</span><br><span class="line">        h &#x3D; g;</span><br><span class="line">        g &#x3D; f;</span><br><span class="line">        f &#x3D; e;</span><br><span class="line">        e &#x3D; d + t1;</span><br><span class="line">        d &#x3D; c;</span><br><span class="line">        c &#x3D; b;</span><br><span class="line">        b &#x3D; a;</span><br><span class="line">        a &#x3D; t1 + t2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">ctx-&gt;state[0] +&#x3D; a;</span><br><span class="line">ctx-&gt;state[1] +&#x3D; b;</span><br><span class="line">ctx-&gt;state[2] +&#x3D; c;</span><br><span class="line">ctx-&gt;state[3] +&#x3D; d;</span><br><span class="line">ctx-&gt;state[4] +&#x3D; e;</span><br><span class="line">ctx-&gt;state[5] +&#x3D; f;</span><br><span class="line">ctx-&gt;state[6] +&#x3D; g;</span><br><span class="line">ctx-&gt;state[7] +&#x3D; h;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void sha256_init(SHA256_CTX *ctx)</span><br><span class="line">&#123;</span><br><span class="line">ctx-&gt;datalen &#x3D; 0;</span><br><span class="line">ctx-&gt;bitlen &#x3D; 0;</span><br><span class="line">ctx-&gt;state[0] &#x3D; 0x6a09e667;</span><br><span class="line">ctx-&gt;state[1] &#x3D; 0xbb67ae85;</span><br><span class="line">ctx-&gt;state[2] &#x3D; 0x3c6ef372;</span><br><span class="line">ctx-&gt;state[3] &#x3D; 0xa54ff53a;</span><br><span class="line">ctx-&gt;state[4] &#x3D; 0x510e527f;</span><br><span class="line">ctx-&gt;state[5] &#x3D; 0x9b05688c;</span><br><span class="line">ctx-&gt;state[6] &#x3D; 0x1f83d9ab;</span><br><span class="line">ctx-&gt;state[7] &#x3D; 0x5be0cd19;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void sha256_update(SHA256_CTX *ctx, const BYTE data[], size_t len)</span><br><span class="line">&#123;</span><br><span class="line">    WORD i;</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0; i &lt; len; ++i) &#123;</span><br><span class="line">ctx-&gt;data[ctx-&gt;datalen] &#x3D; data[i];</span><br><span class="line">ctx-&gt;datalen++;</span><br><span class="line">if (ctx-&gt;datalen &#x3D;&#x3D; 64) &#123;</span><br><span class="line">sha256_transform(ctx, ctx-&gt;data);</span><br><span class="line">ctx-&gt;bitlen +&#x3D; 512;</span><br><span class="line">ctx-&gt;datalen &#x3D; 0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void sha256_final(SHA256_CTX *ctx, BYTE hash[])</span><br><span class="line">&#123;</span><br><span class="line">    WORD i;</span><br><span class="line"></span><br><span class="line">    i &#x3D; ctx-&gt;datalen;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Pad whatever data is left in the buffer.</span><br><span class="line">if (ctx-&gt;datalen &lt; 56) &#123;</span><br><span class="line">ctx-&gt;data[i++] &#x3D; 0x80;</span><br><span class="line">while (i &lt; 56)</span><br><span class="line">ctx-&gt;data[i++] &#x3D; 0x00;</span><br><span class="line">    &#125;</span><br><span class="line">else &#123;</span><br><span class="line">ctx-&gt;data[i++] &#x3D; 0x80;</span><br><span class="line">while (i &lt; 64)</span><br><span class="line">ctx-&gt;data[i++] &#x3D; 0x00;</span><br><span class="line">sha256_transform(ctx, ctx-&gt;data);</span><br><span class="line">memset(ctx-&gt;data, 0, 56);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Append to the padding the total message&#39;s length in bits and transform.</span><br><span class="line">ctx-&gt;bitlen +&#x3D; ctx-&gt;datalen * 8;</span><br><span class="line">ctx-&gt;data[63] &#x3D; ctx-&gt;bitlen;</span><br><span class="line">ctx-&gt;data[62] &#x3D; ctx-&gt;bitlen &gt;&gt; 8;</span><br><span class="line">ctx-&gt;data[61] &#x3D; ctx-&gt;bitlen &gt;&gt; 16;</span><br><span class="line">ctx-&gt;data[60] &#x3D; ctx-&gt;bitlen &gt;&gt; 24;</span><br><span class="line">ctx-&gt;data[59] &#x3D; ctx-&gt;bitlen &gt;&gt; 32;</span><br><span class="line">ctx-&gt;data[58] &#x3D; ctx-&gt;bitlen &gt;&gt; 40;</span><br><span class="line">ctx-&gt;data[57] &#x3D; ctx-&gt;bitlen &gt;&gt; 48;</span><br><span class="line">ctx-&gt;data[56] &#x3D; ctx-&gt;bitlen &gt;&gt; 56;</span><br><span class="line">sha256_transform(ctx, ctx-&gt;data);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Since this implementation uses little endian byte ordering and SHA uses big endian,</span><br><span class="line">&#x2F;&#x2F; reverse all the bytes when copying the final state to the output hash.</span><br><span class="line">for (i &#x3D; 0; i &lt; 4; ++i) &#123;</span><br><span class="line">hash[i]      &#x3D; (ctx-&gt;state[0] &gt;&gt; (24 - i * 8)) &amp; 0x000000ff;</span><br><span class="line">hash[i + 4]  &#x3D; (ctx-&gt;state[1] &gt;&gt; (24 - i * 8)) &amp; 0x000000ff;</span><br><span class="line">hash[i + 8]  &#x3D; (ctx-&gt;state[2] &gt;&gt; (24 - i * 8)) &amp; 0x000000ff;</span><br><span class="line">hash[i + 12] &#x3D; (ctx-&gt;state[3] &gt;&gt; (24 - i * 8)) &amp; 0x000000ff;</span><br><span class="line">hash[i + 16] &#x3D; (ctx-&gt;state[4] &gt;&gt; (24 - i * 8)) &amp; 0x000000ff;</span><br><span class="line">hash[i + 20] &#x3D; (ctx-&gt;state[5] &gt;&gt; (24 - i * 8)) &amp; 0x000000ff;</span><br><span class="line">hash[i + 24] &#x3D; (ctx-&gt;state[6] &gt;&gt; (24 - i * 8)) &amp; 0x000000ff;</span><br><span class="line">hash[i + 28] &#x3D; (ctx-&gt;state[7] &gt;&gt; (24 - i * 8)) &amp; 0x000000ff;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>flag{QuiCK_H4sh_cbDbdBdcd6}</strong></p>
<h3 id="luaplayground01"><a href="#luaplayground01" class="headerlink" title="luaplayground01"></a><strong>luaplayground01</strong></h3><p>鸿蒙系统运行的lua，execute被禁用，通过io读文件，hexencode分段读取</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">function bin2hex(s)</span><br><span class="line">    s&#x3D;string.gsub(s,&quot;(.)&quot;,function (x) return string.format(&quot;%02X &quot;,string.byte(x)) end)</span><br><span class="line">    return s</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">ff&#x3D;io.open(&#39;&#x2F;bin&#x2F;flag_app&#39;,r):read(&quot;*a&quot;)</span><br><span class="line"></span><br><span class="line">print(bin2hex(string.sub(ff,1,300)))</span><br><span class="line">print(bin2hex(string.sub(ff,301,600)))</span><br><span class="line">print(bin2hex(string.sub(ff,601,900)))</span><br><span class="line">print(bin2hex(string.sub(ff,901,1200)))</span><br><span class="line">print(bin2hex(string.sub(ff,1201,1500)))</span><br><span class="line">print(bin2hex(string.sub(ff,1501,1800)))</span><br><span class="line">print(bin2hex(string.sub(ff,1801,2100)))</span><br><span class="line">print(bin2hex(string.sub(ff,2101,2400)))</span><br><span class="line">print(bin2hex(string.sub(ff,2401,2700)))</span><br><span class="line">print(bin2hex(string.sub(ff,2701,3000)))</span><br><span class="line">print(bin2hex(string.sub(ff,3001,3300)))</span><br><span class="line">print(bin2hex(string.sub(ff,3301,3600)))</span><br><span class="line">print(bin2hex(string.sub(ff,3601,3900)))</span><br><span class="line">print(bin2hex(string.sub(ff,3901,4200)))</span><br><span class="line">print(bin2hex(string.sub(ff,4201,4500)))</span><br><span class="line">print(bin2hex(string.sub(ff,4501,4800)))</span><br><span class="line">print(bin2hex(string.sub(ff,4801,5100)))</span><br><span class="line">print(bin2hex(string.sub(ff,5101,5400)))</span><br><span class="line">print(bin2hex(string.sub(ff,5401,5700)))</span><br><span class="line">print(bin2hex(string.sub(ff,5701,6000)))</span><br><span class="line">print(bin2hex(string.sub(ff,6001,6300)))</span><br><span class="line">print(bin2hex(string.sub(ff,6301,6600)))</span><br><span class="line">print(bin2hex(string.sub(ff,6601,6900)))</span><br><span class="line">print(bin2hex(string.sub(ff,6901,7200)))</span><br><span class="line">print(bin2hex(string.sub(ff,7201,7500)))</span><br><span class="line">print(bin2hex(string.sub(ff,7501,7800)))</span><br><span class="line">print(bin2hex(string.sub(ff,7801,8100)))</span><br><span class="line">print(bin2hex(string.sub(ff,8101,8400)))</span><br><span class="line">print(bin2hex(string.sub(ff,8401,8700)))</span><br><span class="line">print(bin2hex(string.sub(ff,8701,9000)))</span><br><span class="line">print(bin2hex(string.sub(ff,9001,9300)))</span><br><span class="line">print(bin2hex(string.sub(ff,9301,9600)))</span><br><span class="line">print(bin2hex(string.sub(ff,9601,9900)))</span><br><span class="line">print(bin2hex(string.sub(ff,9901,10200)))</span><br><span class="line">print(bin2hex(string.sub(ff,10201,10500)))</span><br><span class="line">print(bin2hex(string.sub(ff,10501,10800)))</span><br><span class="line">print(bin2hex(string.sub(ff,10801,11100)))</span><br><span class="line">print(bin2hex(string.sub(ff,11101,11400)))</span><br><span class="line">print(bin2hex(string.sub(ff,11401,11700)))</span><br><span class="line">print(bin2hex(string.sub(ff,11701,12000)))</span><br><span class="line">print(bin2hex(string.sub(ff,12001,12300)))</span><br><span class="line">print(bin2hex(string.sub(ff,12301,12600)))</span><br><span class="line">print(bin2hex(string.sub(ff,12601,12900)))</span><br><span class="line">print(bin2hex(string.sub(ff,12901,13200)))</span><br><span class="line">print(bin2hex(string.sub(ff,13201,13489)))</span><br></pre></td></tr></table></figure>

<p>简单逆向</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">b &#x3D; [0x9C, 0x6D, 0xE7, 0x56, 0x06, 0xD2, 0x0D, 0xEB, 0xDD, 0xF0, 0x9E, 0xB7, 0xFB, 0xE6, 0xEC, 0x3B, 0xB7, 0x5E, 0x75, 0x53, 0xD6, 0x83, 0x75, 0xAF, 0x18, 0xF7, 0x99, 0x95, 0xF2, 0xC1, 0xF2, 0xDB, 0x9F, 0x65, 0xB4, 0x06, 0x49, 0x87, 0x58, 0xE2, 0xDE, 0xB5, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]</span><br><span class="line">a &#x3D; [0xFA, 0x01, 0x86, 0x31, 0x7D, 0xB1, 0x69, 0xD3, 0xB8, 0xC8, 0xA6, 0xD6, 0x98, 0xCB, 0x8E, 0x03, 0xD1, 0x68, 0x58, 0x67, 0xB2, 0xE6, 0x40, 0x82, 0x7A, 0xC3, 0xFD, 0xA1, 0xDF, 0xF0, 0x96, 0xBF]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for i in range(42):</span><br><span class="line">print(chr(b[i] ^ a[i&amp;31]),end&#x3D;&#39;&#39;)</span><br></pre></td></tr></table></figure>

<p><strong>flag{cd8e88ac-b8f6-4de5-b4d4-1dded274611f}</strong></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/CTF/" rel="tag"><i class="fa fa-tag"></i>CTF</a>
          
            <a href="/tags/Crypto/" rel="tag"><i class="fa fa-tag"></i>Crypto</a>
          
            <a href="/tags/Reverse/" rel="tag"><i class="fa fa-tag"></i>Reverse</a>
          
            <a href="/tags/Writeup/" rel="tag"><i class="fa fa-tag"></i>Writeup</a>
          
            <a href="/tags/RealWorld/" rel="tag"><i class="fa fa-tag"></i>RealWorld</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/12/31/2020XNUCA/" rel="next" title="2020XNUCA Reverse 部分Writeup">
                <i class="fa fa-chevron-left"></i> 2020XNUCA Reverse 部分Writeup
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/feng.jpg"
                alt="feng" />
            
              <p class="site-author-name" itemprop="name">feng</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/yifeng-lee" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:feng@m.scnu.edu.cn" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#鲲鹏计算专场-Crypto"><span class="nav-number">1.</span> <span class="nav-text">鲲鹏计算专场 - Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#combinelfsr"><span class="nav-number">1.1.</span> <span class="nav-text">combinelfsr</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RRSSAA"><span class="nav-number">1.2.</span> <span class="nav-text">RRSSAA</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#鲲鹏计算-amp-amp-鸿蒙专场-Reverse"><span class="nav-number">2.</span> <span class="nav-text">鲲鹏计算 &amp;&amp; 鸿蒙专场 - Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#mips"><span class="nav-number">2.1.</span> <span class="nav-text">mips</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pypy"><span class="nav-number">2.2.</span> <span class="nav-text">pypy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#re123"><span class="nav-number">2.3.</span> <span class="nav-text">re123</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#crash"><span class="nav-number">2.4.</span> <span class="nav-text">crash</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#arm"><span class="nav-number">2.5.</span> <span class="nav-text">arm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#arm-pe"><span class="nav-number">2.6.</span> <span class="nav-text">arm_pe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#puzzle"><span class="nav-number">2.7.</span> <span class="nav-text">puzzle</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#鲲鹏计算-amp-amp-鸿蒙专场-RealWorld"><span class="nav-number">3.</span> <span class="nav-text">鲲鹏计算 &amp;&amp; 鸿蒙专场 - RealWorld</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#AESbaby"><span class="nav-number">3.1.</span> <span class="nav-text">AESbaby</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#远程exp"><span class="nav-number">3.1.1.</span> <span class="nav-text">远程exp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#可执行文件源码"><span class="nav-number">3.1.2.</span> <span class="nav-text">可执行文件源码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hash"><span class="nav-number">3.2.</span> <span class="nav-text">Hash</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#exp"><span class="nav-number">3.2.1.</span> <span class="nav-text">exp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#main-c"><span class="nav-number">3.2.2.</span> <span class="nav-text">main.c</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sha256-h"><span class="nav-number">3.2.3.</span> <span class="nav-text">sha256.h</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sha256-c"><span class="nav-number">3.2.4.</span> <span class="nav-text">sha256.c</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#luaplayground01"><span class="nav-number">3.3.</span> <span class="nav-text">luaplayground01</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright"><font color=black face=STLiti>Copyright &nbsp;</font><font color=black>&copy;</font> <font color=black face=STLiti><span itemprop="copyrightYear">2021</span></font>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder" style="font-family:STLiti;color:black;">feng . All Rights Reserved.</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
